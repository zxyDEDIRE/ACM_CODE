
<!doctype html>
<html lang="zh" data-hairline="true" class="itcauecng" data-theme="light"><head><meta charSet="utf-8"/><title data-rh="true">一文读懂ninja构建系统 - 知乎</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"/><meta name="renderer" content="webkit"/><meta name="force-rendering" content="webkit"/><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/><meta name="google-site-verification" content="FTeR0c8arOPKh8c5DYh_9uu98_zJbaWw53J-Sch9MTg"/><meta data-rh="true" name="keywords" content="CMake,PyTorch,C / C++"/><meta data-rh="true" name="description" content="很多大型项目（例如PyTorch）都采用了ninja作为构建系统的一部分，为了阅读并了解这些大型项目，有必要对ninja有初步理解。 ninja简单介绍 ninja是一种构建工具，用来调用各种工具（代码生成器、编译器、链接器等…"/><meta data-rh="true" property="og:title" content="一文读懂ninja构建系统"/><meta data-rh="true" property="og:url" content="https://zhuanlan.zhihu.com/p/676733751"/><meta data-rh="true" property="og:description" content="很多大型项目（例如PyTorch）都采用了ninja作为构建系统的一部分，为了阅读并了解这些大型项目，有必要对ninja有初步理解。 ninja简单介绍 ninja是一种构建工具，用来调用各种工具（代码生成器、编译器、链接器等…"/><meta data-rh="true" property="og:image" content="https://picx.zhimg.com/v2-61b13975832b12bc4f988961e5557af6_720w.jpg?source=172ae18b"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="og:site_name" content="知乎专栏"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-152.81060cab.png" sizes="152x152"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-120.d5793cac.png" sizes="120x120"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-76.7abf3393.png" sizes="76x76"/><link data-rh="true" rel="apple-touch-icon" href="https://static.zhihu.com/heifetz/assets/apple-touch-icon-60.362a8eac.png" sizes="60x60"/><link crossorigin="" rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico"/><link crossorigin="" rel="search" type="application/opensearchdescription+xml" href="https://static.zhihu.com/heifetz/search.xml" title="知乎"/><link rel="dns-prefetch" href="//static.zhimg.com"/><link rel="dns-prefetch" href="//pica.zhimg.com"/><link rel="dns-prefetch" href="//picx.zhimg.com"/><link rel="dns-prefetch" href="//pic1.zhimg.com"/><link rel="dns-prefetch" href="//pic2.zhimg.com"/><link rel="dns-prefetch" href="//pic3.zhimg.com"/><link rel="dns-prefetch" href="//pic4.zhimg.com"/><link rel="dns-prefetch" href="//static.zhihu.com"/><script nonce="4d7e1adc-0b4b-4271-a73e-7dadcb713f6a" data-web-reporter-config="{&quot;platform&quot;:&quot;web&quot;,&quot;project&quot;:&quot;heifetz&quot;}">!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).webReporter={})}(this,function(e){"use strict";var t={},n=!1,o=function(){var e,o,r,a,i;return n||(e=document.querySelector("script[data-web-reporter-config]"),o=e&&e.dataset.webReporterConfig||"{}",r=JSON.parse(o),a=r.platform,i=r.project,t={platform:a,project:i},n=!0),t};function r(e){return a(function(){return localStorage.getItem(e)})()}function a(e){return function(){try{return e.apply(void 0,arguments)}catch(e){}}}var i=a(function(e,t){var n={platform:"web",project:o().project,clientTimestamp:+new Date};!function(e,t,n){"1"===r("weber:logenabled")&&console.log("[web-reporter]%o",{type:e,base:t,data:n})}(e,n,t),function(e,t){var n=btoa(JSON.stringify(t));if("undefined"!=typeof Blob&&window.navigator&&window.navigator.sendBeacon){var o=new Blob([n],{type:"text/plain"});navigator.sendBeacon(e,o)}else{var r=new XMLHttpRequest;r.open("POST",e),r.withCredentials=!1,r.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),r.send(n)}}(r("weber:api")||"https://apm.zhihu.com/collector/web_json",{type:e,base:n,data:t})});e.report=i,Object.defineProperty(e,"__esModule",{value:!0})});
</script><link href="https://static.zhihu.com/heifetz/419.216a26f4.91003401be5a8e118f67.css" crossorigin="" rel="stylesheet"/><link href="https://static.zhihu.com/heifetz/column.216a26f4.936827b41f006f6d2f47.css" crossorigin="" rel="stylesheet"/><script nonce="4d7e1adc-0b4b-4271-a73e-7dadcb713f6a">!function(){"use strict";!function(e,n){var r=[];function t(e){return function(){r.push([e,arguments])}}n.Raven={captureException:t("captureException"),captureMessage:t("captureMessage"),captureBreadcrumb:t("captureBreadcrumb")};var a,o,c,i,s,u="undefined"!=typeof DOMError;function d(e){var n=e instanceof Error||e instanceof ErrorEvent||u&&e instanceof DOMError||e instanceof DOMException;Raven.captureException(n?e:new Error(e.message||e.reason))}n.addEventListener("unhandledrejection",d),n.addEventListener("error",d,!0),a=e.src,o=e,c=function(){r.forEach(function(e){var n;(n=Raven)[e[0]].apply(n,e[1])}),n.removeEventListener("unhandledrejection",d),n.removeEventListener("error",d,!0)},i=document.head||document.getElementsByTagName("head")[0],(s=document.createElement("script")).crossOrigin=o.crossOrigin,s.dataset.sentryConfig=o["data-sentry-config"],s.onload=c,s.src=a,i.appendChild(s)}({"defer":true,"crossOrigin":"anonymous","src":"https://unpkg.zhimg.com/@cfe/sentry-script@1.3.1/dist/init.js","data-sentry-config":"{\"dsn\":\"https://2d8d764432cc4f6fb3bc78ab9528299d@crash2.zhihu.com/1224\",\"sampleRate\":0.1,\"release\":\"1179-c59a44b3\",\"ignoreErrorNames\":[\"NetworkError\",\"SecurityError\"],\"ignoreErrorsPreset\":\"ReactApp\",\"tags\":{\"app_name\":\"heifetz\"}}"},window)}();
</script></head><body class="WhiteBg-body PostIndex-body"><div id="root"><div class="App"><style data-emotion-css="55n9hh">.css-55n9hh{position:fixed;top:0;right:0;left:0;z-index:101;display:none;height:2px;pointer-events:none;background:#1772F6;-webkit-transform:translateX(-100%);-ms-transform:translateX(-100%);transform:translateX(-100%);}</style><div class="LoadingBar  css-55n9hh"></div><div><span style="position:absolute;top:-10000px;left:-10000px" role="log" aria-live="assertive"></span></div><main role="main" class="App-main"><div class="Post-content" data-zop-usertoken="{&quot;userToken&quot;:&quot;&quot;}" data-zop="{&quot;authorName&quot;:&quot;游凯超&quot;,&quot;itemId&quot;:676733751,&quot;title&quot;:&quot;一文读懂ninja构建系统&quot;,&quot;type&quot;:&quot;article&quot;}"><div class="ColumnPageHeader-Wrapper"><div><style data-emotion-css="1l12z7y">.css-1l12z7y{box-shadow:0px 16px 32px rgba(0,0,0,0.04);}</style><div class="Sticky ColumnPageHeader css-1l12z7y"><div class="ColumnPageHeader-content"><a href="//www.zhihu.com" aria-label="知乎"><style data-emotion-css="1hlrcxk">.css-1hlrcxk{-webkit-transition-property:fill;transition-property:fill;-webkit-transition-duration:0.25s;transition-duration:0.25s;-webkit-transition-timing-function:ease-in;transition-timing-function:ease-in;}</style><svg viewBox="0 0 64 30" fill="#1772F6" width="64" height="30" class="css-1hlrcxk"><path d="M29.05 4.582H16.733V25.94h3.018l.403 2.572 4.081-2.572h4.815V4.582zm-5.207 18.69l-2.396 1.509-.235-1.508h-1.724V7.233h6.78v16.04h-2.425zM14.46 14.191H9.982c0-.471.033-.954.039-1.458v-5.5h5.106V5.935a1.352 1.352 0 0 0-.404-.957 1.378 1.378 0 0 0-.968-.396H5.783c.028-.088.056-.177.084-.255.274-.82 1.153-3.326 1.153-3.326a4.262 4.262 0 0 0-2.413.698c-.57.4-.912.682-1.371 1.946-.532 1.453-.997 2.856-1.31 3.693C1.444 8.674.28 11.025.28 11.025a5.85 5.85 0 0 0 2.52-.61c1.119-.593 1.679-1.502 2.054-2.883l.09-.3h2.334v5.5c0 .5-.045.982-.073 1.46h-4.12c-.71 0-1.39.278-1.893.775a2.638 2.638 0 0 0-.783 1.874h6.527a17.717 17.717 0 0 1-.778 3.649 16.796 16.796 0 0 1-3.012 5.273A33.104 33.104 0 0 1 0 28.74s3.13 1.175 5.425-.954c1.388-1.292 2.631-3.814 3.23-5.727a28.09 28.09 0 0 0 1.12-5.229h5.967v-1.37a1.254 1.254 0 0 0-.373-.899 1.279 1.279 0 0 0-.909-.37z"></path><path d="M11.27 19.675l-2.312 1.491 5.038 7.458a6.905 6.905 0 0 0 .672-2.218 3.15 3.15 0 0 0-.28-2.168l-3.118-4.563zM51.449 15.195V5.842c4.181-.205 7.988-.405 9.438-.483l.851-.05c.387-.399.885-2.395.689-3.021-.073-.25-.213-.666-.638-.555a33.279 33.279 0 0 1-4.277.727c-2.766.321-3.97.404-7.804.682-6.718.487-12.709.72-12.709.72a2.518 2.518 0 0 0 .788 1.834 2.567 2.567 0 0 0 1.883.706c2.278-.095 5.598-.25 8.996-.41v9.203h-12.78c0 .703.281 1.377.783 1.874a2.69 2.69 0 0 0 1.892.777h10.105v7.075c0 .887-.464 1.192-1.231 1.214h-3.92a4.15 4.15 0 0 0 .837 1.544 4.2 4.2 0 0 0 1.403 1.067 6.215 6.215 0 0 0 2.71.277c1.36-.066 2.967-.826 2.967-3.57v-7.607h11.28c.342 0 .67-.135.91-.374.242-.239.378-.563.378-.902v-1.375H51.449z"></path><path d="M42.614 8.873a2.304 2.304 0 0 0-1.508-.926 2.334 2.334 0 0 0-1.727.405l-.376.272 4.255 5.85 2.24-1.62-2.884-3.98zM57.35 8.68l-3.125 4.097 2.24 1.663 4.517-5.927-.375-.277a2.32 2.32 0 0 0-1.722-.452 2.327 2.327 0 0 0-1.536.896z"></path></svg></a><div class="ColumnPageHeader-Button"><div class="Popover"><button title="更多" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content" type="button" class="Button ColumnPageHeader-MenuToggler FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--Dots" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></button></div><button type="button" class="Button ColumnPageHeader-WriteButton FEfUrdfMIKpQDJDqkjte Button--blue JmYzaky7MEPMFcJDLNMG"><svg width="24" height="24" viewBox="0 0 24 24" class="Zi Zi--EditSurround" fill="currentColor"><path d="M4.352 6.804A2.554 2.554 0 0 1 6.905 4.25h6.072a.875.875 0 0 0 0-1.75H6.905a4.304 4.304 0 0 0-4.303 4.304v10.142a4.304 4.304 0 0 0 4.303 4.304h10.143a4.304 4.304 0 0 0 4.304-4.304v-6.071a.875.875 0 0 0-1.75 0v6.071a2.554 2.554 0 0 1-2.554 2.554H6.905a2.554 2.554 0 0 1-2.553-2.554V6.804Z"></path><path d="M20.595 4.731a.875.875 0 1 0-1.237-1.237l-7.763 7.762a.875.875 0 1 0 1.238 1.238l7.762-7.763Z"></path></svg>写文章</button></div></div><div class="ColumnPageHeader-profile"><button type="button" class="Button AppHeader-profileEntry FEfUrdfMIKpQDJDqkjte Button--plain fEPKGkUK5jyc4fUuT0QP"><style data-emotion-css="icip60">.css-icip60{border-radius:2px;}</style><style data-emotion-css="fnnb9l">.css-fnnb9l{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:30px;height:30px;border-radius:2px;}</style><img class="Avatar AppHeader-profileAvatar css-fnnb9l" src="https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpeg" srcSet="https://pic1.zhimg.com/v2-abed1a8c04700ba7d72b45195223e0ff_l.jpeg 2x" alt="点击打开undefined的主页"/></button></div></div></div></div><style data-emotion-css="78p1r9">.css-78p1r9{box-sizing:border-box;margin:0;min-width:0;margin-left:auto;margin-right:auto;max-width:690px;margin-top:0;}@media screen and (min-width:40em){.css-78p1r9{margin-top:1em;}}</style><div class="css-78p1r9"><style data-emotion-css="rt8oft">.css-rt8oft{position:relative;padding-bottom:40.5%;height:0;border-radius:inherit;}</style><style data-emotion-css="tlwe03">.css-tlwe03{box-sizing:border-box;margin:0;min-width:0;position:relative;padding-bottom:40.5%;height:0;border-radius:inherit;}</style><div class="css-tlwe03"><style data-emotion-css="1ld0bim">.css-1ld0bim{position:absolute;top:0;left:0;width:100%;height:100%;border-radius:inherit;}</style><div class="css-1ld0bim"><span style="box-sizing:border-box;display:block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0"><picture><img alt="一文读懂ninja构建系统" decoding="async" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;filter:blur(20px);background-size:cover;background-image:url(&quot;data:image/svg+xml;charset=utf8,%3Csvg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; width=&#x27;1&#x27; height=&#x27;1&#x27;%3E%3Crect width=&#x27;1&#x27; height=&#x27;1&#x27; fill=&#x27;%23F6F6F6&#x27;/%3E%3C/svg%3E&quot;);background-position:0% 0%" width="100%" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"/></picture></span></div></div></div><article class="Post-Main Post-NormalMain" tabindex="-1"><header class="Post-Header"><h1 class="Post-Title">一文读懂ninja构建系统</h1><div class="Post-Author"><div class="AuthorInfo" itemProp="author" itemscope="" itemType="http://schema.org/Person"><div class="AuthorInfo"><meta itemProp="name" content="游凯超"/><meta itemProp="image" content="https://picx.zhimg.com/v2-4cd09992e39c66a3a177e6fd07e7cecf_l.jpg?source=172ae18b"/><meta itemProp="url" content="https://www.zhihu.com/people/youkaichao"/><meta itemProp="zhihu:followerCount"/><span class="UserLink AuthorInfo-avatarWrapper"><a href="//www.zhihu.com/people/youkaichao" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User"><style data-emotion-css="uodor8">.css-uodor8{border-radius:50%;}</style><style data-emotion-css="1syywx2">.css-1syywx2{box-sizing:border-box;margin:0;min-width:0;max-width:100%;height:auto;background-color:#ffffff;width:38px;height:38px;border-radius:50%;}</style><img class="Avatar AuthorInfo-avatar css-1syywx2" src="https://picx.zhimg.com/v2-4cd09992e39c66a3a177e6fd07e7cecf_l.jpg?source=172ae18b" srcSet="https://picx.zhimg.com/v2-4cd09992e39c66a3a177e6fd07e7cecf_l.jpg?source=172ae18b 2x" alt="游凯超"/></a></span><div class="AuthorInfo-content"><div class="AuthorInfo-head"><span class="UserLink AuthorInfo-name"><a href="//www.zhihu.com/people/youkaichao" target="_blank" class="UserLink-link" data-za-detail-view-element_name="User">游凯超</a><style data-emotion-css="1cd9gw4">.css-1cd9gw4{margin-left:.3em;}</style><style data-emotion-css="4gq0sj">.css-4gq0sj{box-sizing:border-box;margin:0;min-width:0;color:#09408e;display:inline-block;margin-left:.3em;}</style><a href="https://www.zhihu.com/question/48509984" target="_blank" class="css-4gq0sj" aria-label="深度学习（Deep Learning）话题下的优秀答主" data-tooltip="深度学习（Deep Learning）话题下的优秀答主"><style data-emotion-css="18biwo">.css-18biwo{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><span class="css-18biwo">​<style data-emotion-css="1ifz0go">.css-1ifz0go{overflow:visible!important;}</style><svg viewBox="0 0 24 24" class="css-1ifz0go" width="18" height="18"><defs><linearGradient id="biz-badges-yellow" x1="0%" y1="0" x2="100%" y2="56.65%"><stop offset="24.71%" stop-color="#FFAB38"></stop><stop offset="81.88%" stop-color="#FF5B14"></stop></linearGradient></defs><svg viewBox="0 0 24 24" x="-3" y="-3" fill="#ffffff" width="30" height="30"><path d="M3.56231227,13.8535307 C2.40051305,12.768677 2.41398885,11.0669203 3.59484487,9.99979213 L3.59222085,9.99654885 C4.26730143,9.45036719 4.79446755,8.21005186 4.7184197,7.34453784 L4.72305873,7.34412719 C4.66942824,5.75539997 5.8824188,4.56066914 7.47188965,4.64242381 L7.47229112,4.6386236 C8.33515314,4.72977993 9.58467253,4.22534048 10.1426329,3.55925173 L10.1462611,3.56228565 C11.2316055,2.40008701 12.9353108,2.41394456 14.0015072,3.59634088 L14.0047263,3.59374004 C14.5498229,4.26841874 15.7896857,4.79521622 16.6545744,4.71844347 L16.6549836,4.72304294 C18.245027,4.66894057 19.4396947,5.88213996 19.3575031,7.47241135 L19.3623099,7.47292747 C19.2704388,8.3358681 19.7742711,9.58421483 20.4407199,10.1424506 L20.437686,10.1460789 C21.5997217,11.2312209 21.5860695,12.9345218 20.4042441,14.0007396 L20.4072865,14.0045125 C19.7325967,14.5495925 19.2055209,15.7896954 19.2815865,16.6561959 L19.2770449,16.6565978 C19.3315454,18.2453037 18.1173775,19.4393568 16.5274188,19.3571512 L16.5269029,19.3619539 C15.6647098,19.270083 14.415408,19.7741709 13.8573671,20.4403558 L13.8537409,20.4373235 C12.76842,21.5995708 11.0650432,21.5864553 9.99899434,20.4039226 L9.99527367,20.406923 C9.45025436,19.7323399 8.21017638,19.2051872 7.34461983,19.2812352 L7.344304,19.2776405 C5.75448683,19.3312904 4.55977145,18.1170085 4.64254978,16.527117 L4.63769921,16.5265942 C4.72957031,15.6644394 4.22547659,14.4151814 3.55928015,13.8571569 L3.56231227,13.8535307 Z"></path></svg><path d="M2.63951518,13.3895441 C3.70763333,14.2842292 4.44777637,16.1226061 4.30075305,17.5023312 L4.32211542,17.3063047 C4.17509209,18.6910561 5.17786655,19.7063729 6.5613937,19.5844846 L6.364106,19.6008202 C7.75140298,19.4789319 9.57474349,20.2554985 10.4468305,21.3349009 L10.3224262,21.1803415 C11.1982831,22.2647703 12.6257916,22.2723098 13.5167278,21.2079863 L13.3898102,21.3600325 C14.2845162,20.2919393 16.1229361,19.5518136 17.5026934,19.6988334 L17.3054057,19.6774716 C18.6914461,19.8244915 19.7067866,18.8217404 19.5836389,17.4395022 L19.6012314,17.6367853 C19.4793403,16.2482641 20.255925,14.4249662 21.3353526,13.5528995 L21.1807897,13.677301 C22.2639871,12.8014646 22.2727834,11.3739894 21.2084351,10.483074 L21.3604848,10.6099886 C20.2923667,9.71530351 19.5522236,7.87818322 19.6992469,6.49720154 L19.6778846,6.69448464 C19.8249079,5.30847665 18.8221335,4.2944164 17.4386063,4.41630468 L17.635894,4.39871256 C16.248597,4.52185742 14.4252565,3.74529084 13.5531695,2.66588842 L13.6775738,2.81919121 C12.8017169,1.73601905 11.3742084,1.72722299 10.4832722,2.79154644 L10.6101898,2.63950024 C9.71548377,3.70759343 7.87706394,4.44771919 6.49730661,4.30195588 L6.69459432,4.32206116 C5.30855394,4.17504128 4.29447,5.17904888 4.41636114,6.56128713 L4.3987686,6.36400404 C4.52065973,7.75126861 3.74407501,9.57456653 2.66464737,10.4478898 L2.81921035,10.3222318 C1.73601288,11.1993248 1.72721662,12.6255433 2.79156494,13.5164587 L2.63951518,13.3895441 Z" fill="url(#biz-badges-yellow)"></path><svg class="Zi Zi--Star" fill="#fff" x="6" y="6" viewBox="0 0 24 24" width="12" height="12"><path d="M5.515 19.64l.918-5.355-3.89-3.792c-.926-.902-.639-1.784.64-1.97L8.56 7.74l2.404-4.871c.572-1.16 1.5-1.16 2.072 0L15.44 7.74l5.377.782c1.28.186 1.566 1.068.64 1.97l-3.89 3.793.918 5.354c.219 1.274-.532 1.82-1.676 1.218L12 18.33l-4.808 2.528c-1.145.602-1.896.056-1.677-1.218z" fill-rule="evenodd"></path></svg></svg></span></a></span></div><div class="AuthorInfo-detail"><div class="AuthorInfo-badge"><div class="ztext AuthorInfo-badgeText css-0">深度学习（Deep Learning）话题下的优秀答主</div></div></div></div></div></div><button type="button" class="Button FollowButton FEfUrdfMIKpQDJDqkjte Button--primary Button--blue epMJl0lFQuYbC7jrwr_o JmYzaky7MEPMFcJDLNMG"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Plus FollowButton-icon" fill="currentColor"><path fill-rule="evenodd" d="M13.25 3.25a1.25 1.25 0 1 0-2.5 0v7.5h-7.5a1.25 1.25 0 1 0 0 2.5h7.5v7.5a1.25 1.25 0 1 0 2.5 0v-7.5h7.5a1.25 1.25 0 0 0 0-2.5h-7.5v-7.5Z" clip-rule="evenodd"></path></svg></span>关注他</button></div><style data-emotion-css="z4ujak">.css-z4ujak{color:#8491a5;}</style><span class="css-z4ujak"></span></header><div class="Post-RichTextContainer"><style data-emotion-css="1yuhvjn">.css-1yuhvjn{margin-top:16px;}</style><div class="css-1yuhvjn"><style data-emotion-css="376mun">.css-376mun{position:relative;display:inline;}</style><div class="css-376mun"><style data-emotion-css="dg64xe">.css-dg64xe .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-dg64xe .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-dg64xe .FileLinkCard-info{margin-left:12px;}.css-dg64xe .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-dg64xe .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-dg64xe .FileLinkCard-source{white-space:pre;}.css-dg64xe img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-dg64xe img.content_image[data-size="normal"],.css-dg64xe img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-dg64xe img.content_image[data-size="small"],.css-dg64xe img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style data-emotion-css="1vqsdx1">.css-1vqsdx1 .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-1vqsdx1 .LinkCard.new,.css-1vqsdx1 .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-1vqsdx1 .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-1vqsdx1 .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-1vqsdx1 .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-1vqsdx1 .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-1vqsdx1 .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-1vqsdx1 .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-1vqsdx1 .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-1vqsdx1 .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-1vqsdx1 .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-1vqsdx1 .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-1vqsdx1 .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-1vqsdx1 .LinkCard.old,.css-1vqsdx1 .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-1vqsdx1 .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}</style><style data-emotion-css="yxro2d">.css-yxro2d .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-yxro2d .LinkCard.old,.css-yxro2d .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-yxro2d .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-yxro2d .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-yxro2d .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-yxro2d .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-yxro2d .LinkCard.new,.css-yxro2d .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-yxro2d .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-yxro2d .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-yxro2d .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-yxro2d .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-yxro2d .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-yxro2d .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-yxro2d .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-yxro2d .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-yxro2d .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-yxro2d .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-yxro2d .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-yxro2d .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-yxro2d .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-yxro2d .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-yxro2d .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-yxro2d .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-yxro2d .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-yxro2d .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-yxro2d .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-yxro2d .FileLinkCard-info{margin-left:12px;}.css-yxro2d .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-yxro2d .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-yxro2d .FileLinkCard-source{white-space:pre;}.css-yxro2d img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-yxro2d img.content_image[data-size="normal"],.css-yxro2d img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-yxro2d img.content_image[data-size="small"],.css-yxro2d img.origin_image[data-size="small"]{width:320px;max-width:100%;}</style><style data-emotion-css="jflero animation-1yvu044">.css-jflero{word-break:break-word;line-height:1.6;}.css-jflero > [data-first-child]{margin-top:0;}.css-jflero > :last-child{margin-bottom:0;}.css-jflero h1,.css-jflero h2{clear:left;margin-top:calc((1.4em * 2) / 1.2);margin-bottom:calc(1.4em / 1.2);font-size:1.2em;line-height:1.5;font-weight:600;}.css-jflero h3,.css-jflero h4,.css-jflero h5,.css-jflero h6{clear:left;margin-top:calc((1.4em * 1.5) / 1.1);margin-bottom:calc(1.4em / 1.1);font-size:1.1em;line-height:1.5;font-weight:600;}.css-jflero u{-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #373a40;}.css-jflero b{font-weight:600;}.css-jflero sup{font-size:0.8em;}.css-jflero sup[data-draft-type='reference']{color:#09408e;}.css-jflero a:focus{outline:none;-webkit-transition:box-shadow 0.3s;transition:box-shadow 0.3s;}html[data-focus-visible] .css-jflero a:focus{box-shadow:0 0 0 2px #ffffff,0 0 0 4px rgba(23,114,246,0.3);}.css-jflero a.ztext-link,.css-jflero a.internal,.css-jflero a.external{-webkit-text-decoration:none;text-decoration:none;cursor:pointer;border-bottom:1px solid #81858f;}.css-jflero a.ztext-link:hover,.css-jflero a.internal:hover,.css-jflero a.external:hover{color:#09408e;border-bottom:1px solid #09408e;}.css-jflero a.ztext-link > .ellipsis::after,.css-jflero a.internal > .ellipsis::after,.css-jflero a.external > .ellipsis::after{content:'...';}.css-jflero a.ztext-link > .invisible,.css-jflero a.internal > .invisible,.css-jflero a.external > .invisible{font:0/0 a;color:transparent;text-shadow:none;background-color:transparent;}.css-jflero a.ztext-link u,.css-jflero a.internal u,.css-jflero a.external u{border:none;}.css-jflero a.member_mention{color:#09408e;}.css-jflero a.member_mention:hover{border-bottom:1px solid #09408e;}.css-jflero a.UserLink-link{color:#09408e;}.css-jflero a.UserLink-link:hover{border-bottom:1px solid #09408e;}.css-jflero p{margin:1.4em 0;}.css-jflero p.ztext-empty-paragraph{margin:calc((2.8em- (1.4em * 2 + 1.6em)) / 2) 0;}.css-jflero p.ztext-empty-paragraph + .ztext-empty-paragraph{margin:1.4em 0;}.css-jflero hr{margin:4em auto;width:240px;max-width:100%;border:none;border-top:1px solid #c4c7ce;}.css-jflero img[eeimg]{max-width:100%;vertical-align:middle;}.css-jflero img[eeimg="1"]{margin:0 3px;max-width:calc(100% - 6px);display:inline-block;}.css-jflero img[eeimg="2"]{margin:1.4em auto;display:block;}.css-jflero blockquote{margin:1.4em 0;padding-left:1em;color:#535861;border-left:3px solid #c4c7ce;}.css-jflero ol,.css-jflero ul{margin:1.4em 0;padding:0;width:100%;}.css-jflero ol ol,.css-jflero ul ol,.css-jflero ol ul,.css-jflero ul ul{margin:0;}.css-jflero ol li::before,.css-jflero ul li::before{width:1em;}.css-jflero ol > ol,.css-jflero ul > ol,.css-jflero ol > ul,.css-jflero ul > ul{padding-left:1em;box-sizing:border-box;}.css-jflero ul>li{display:table;width:100%;list-style:none;}.css-jflero ul>li::before{display:table-cell;content:'•  ';white-space:pre;}.css-jflero ol{counter-reset:ol;}.css-jflero ol > li{display:table;width:100%;list-style:none;}.css-jflero ol > li::before{display:table-cell;text-align:right;counter-increment:ol;content:counter(ol) '. ';white-space:pre;}.css-jflero ol ol{counter-reset:ol2;}.css-jflero ol ol li::before{counter-increment:ol2;content:counter(ol2) '. ';}.css-jflero ol ol ol{counter-reset:ol3;}.css-jflero ol ol ol li::before{counter-increment:ol3;content:counter(ol3) '. ';}.css-jflero ol ol ol ol{counter-reset:ol4;}.css-jflero ol ol ol ol li::before{counter-increment:ol4;content:counter(ol4) '. ';}.css-jflero figure{margin:1.4em 0;}.css-jflero figure .content_image,.css-jflero figure .origin_image{margin:0 auto;}.css-jflero figure figcaption{margin-top:calc(0.6em / 0.9);padding:0 1em;font-size:0.9em;line-height:1.5;text-align:center;color:#9196a1;}.css-jflero figure + figure{margin-top:calc(1.4em * 1.6);}.css-jflero figure[data-size='small'],.css-jflero figure:not([data-size]) > [data-size='small']{clear:both;}.css-jflero figure[data-size='left'],.css-jflero figure:not([data-size]) > [data-size='left']{float:left;margin:0 20px 20px 0;max-width:33%;}.css-jflero figure[data-size='right'],.css-jflero figure:not([data-size]) > [data-size='right']{float:right;margin:0 0 20px 20px;max-width:33%;}.css-jflero figure[data-size='collapse']{margin-bottom:0;}.css-jflero figure[data-size='collapse'] + figure{margin-top:0;}.css-jflero .content_image,.css-jflero .origin_image{display:block;max-width:100%;height:auto;margin:1.4em auto;}.css-jflero .content_image[data-size='small'],.css-jflero .origin_image[data-size='small']{max-width:40%;}.css-jflero .content_image.zh-lightbox-thumb,.css-jflero .origin_image.zh-lightbox-thumb{cursor:-webkit-zoom-in;cursor:-moz-zoom-in;cursor:zoom-in;}.css-jflero code{margin:0 2px;padding:3px 4px;border-radius:3px;font-family:Menlo,Monaco,Consolas,'Andale Mono','lucida console','Courier New',monospace;font-size:0.9em;background-color:#f8f8fa;}.css-jflero pre{margin:1.4em 0;padding:calc(0.8em / 0.9);font-size:0.9em;word-break:initial;word-wrap:initial;white-space:pre;overflow:auto;-webkit-overflow-scrolling:touch;background:#f8f8fa;border-radius:4px;}.css-jflero pre code{margin:0;padding:0;font-size:inherit;border-radius:0;background-color:inherit;}.css-jflero li pre{white-space:pre-wrap;}.css-jflero table[data-draft-type='table']{border-collapse:collapse;font-size:15px;margin:1.4em auto;max-width:100%;table-layout:fixed;text-align:left;width:100%;}.css-jflero table[data-draft-type='table'][data-size='small']{min-width:260px;width:40%;}.css-jflero table[data-draft-type='table'][data-row-style='striped'] tr:nth-of-type(2n + 1){background:#f8f8fa;}.css-jflero table[data-draft-type='table'] td,.css-jflero table[data-draft-type='table'] th{border:1px solid #c4c7ce;line-height:24px;height:24px;padding:3px 12px;}.css-jflero table[data-draft-type='table'] th{background:#ebeced;color:#191B1F;font-weight:500;}.css-jflero .video-box,.css-jflero .link-box{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;margin:1.4em 0;overflow:auto;white-space:normal;cursor:pointer;border:solid 1px #ebeced;border-radius:4px;}.css-jflero .lazy[data-lazy-status]{background-color:#f8f8fa;}.css-jflero .lazy[data-lazy-status="ok"]{background-color:transparent;-webkit-animation:animation-1yvu044 0.5s ease-in;animation:animation-1yvu044 0.5s ease-in;}.css-jflero .highlight{margin:1em 0;}.css-jflero .highlight pre{margin:0;}.css-jflero .highlight .hll{background-color:#f8f8fa;}.css-jflero .highlight .c{font-style:italic;color:#9196a1;}.css-jflero .highlight .err{color:#D95350;}.css-jflero .highlight .k{font-weight:600;}.css-jflero .highlight .o{font-weight:600;}.css-jflero .highlight .cm{font-style:italic;color:#9196a1;}.css-jflero .highlight .cp{font-weight:600;color:#9196a1;}.css-jflero .highlight .c1{font-style:italic;color:#9196a1;}.css-jflero .highlight .cs{font-style:italic;font-weight:600;color:#9196a1;}.css-jflero .highlight .gd{color:#F05159;}.css-jflero .highlight .ge{font-style:italic;}.css-jflero .highlight .gr{color:#D95350;}.css-jflero .highlight .gh{color:#9196a1;}.css-jflero .highlight .gi{color:#12b370;}.css-jflero .highlight .go{color:#81858f;}.css-jflero .highlight .gp{color:#535861;}.css-jflero .highlight .gs{font-weight:600;}.css-jflero .highlight .gu{color:#9196a1;}.css-jflero .highlight .gt{color:#D95350;}.css-jflero .highlight .kc{font-weight:600;}.css-jflero .highlight .kd{font-weight:600;}.css-jflero .highlight .kn{font-weight:600;}.css-jflero .highlight .kp{font-weight:600;}.css-jflero .highlight .kr{font-weight:600;}.css-jflero .highlight .kt{font-weight:600;color:#09408e;}.css-jflero .highlight .m{color:#1772F6;}.css-jflero .highlight .s{color:#D95350;}.css-jflero .highlight .na{color:#1772F6;}.css-jflero .highlight .nb{color:#1772F6;}.css-jflero .highlight .nc{font-weight:600;color:#09408e;}.css-jflero .highlight .no{color:#1772F6;}.css-jflero .highlight .ni{color:#6A5FF3;}.css-jflero .highlight .ne{font-weight:600;color:#D95350;}.css-jflero .highlight .nf{font-weight:600;color:#D95350;}.css-jflero .highlight .nn{color:#535861;}.css-jflero .highlight .nt{color:#09408e;}.css-jflero .highlight .nv{color:#1772F6;}.css-jflero .highlight .ow{font-weight:600;}.css-jflero .highlight .w{color:#adb1b7;}.css-jflero .highlight .mf{color:#1772F6;}.css-jflero .highlight .mh{color:#1772F6;}.css-jflero .highlight .mi{color:#1772F6;}.css-jflero .highlight .mo{color:#1772F6;}.css-jflero .highlight .sb{color:#D95350;}.css-jflero .highlight .sc{color:#D95350;}.css-jflero .highlight .sd{color:#D95350;}.css-jflero .highlight .s2{color:#D95350;}.css-jflero .highlight .se{color:#D95350;}.css-jflero .highlight .sh{color:#D95350;}.css-jflero .highlight .si{color:#D95350;}.css-jflero .highlight .sx{color:#D95350;}.css-jflero .highlight .sr{color:#A5542F;}.css-jflero .highlight .s1{color:#D95350;}.css-jflero .highlight .ss{color:#D95350;}.css-jflero .highlight .bp{color:#9196a1;}.css-jflero .highlight .vc{color:#1772F6;}.css-jflero .highlight .vg{color:#1772F6;}.css-jflero .highlight .vi{color:#1772F6;}.css-jflero .highlight .il{color:#1772F6;}.css-jflero .highlight::-webkit-scrollbar{width:6px;height:6px;}.css-jflero .highlight::-webkit-scrollbar-thumb:horizontal{background-color:rgba(25,27,31,0.5);border-radius:6px;}.css-jflero .highlight::-webkit-scrollbar-thumb:horizontal:hover{background-color:rgba(25,27,31,0.6);}.css-jflero .LinkCard.old{position:relative;display:block;margin:1em auto;width:390px;box-sizing:border-box;border-radius:12px;max-width:100%;overflow:hidden;}.css-jflero .LinkCard.old,.css-jflero .LinkCard.old:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-jflero .LinkCard-ecommerceLoadingCard{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;padding:12px;border-radius:inherit;height:80px;box-sizing:border-box;background:rgba(248,248,250,0.88);color:#c4c7ce;}.css-jflero .LinkCard-ecommerceLoadingCardAvatarWrapper{width:60px;height:60px;background:#ebeced;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;border-radius:6px;margin-right:10px;}.css-jflero .LinkCard-ecommerceLoadingCardNetwork{width:20px;height:20px;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar{height:60px;-webkit-flex:1;-ms-flex:1;flex:1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar span{height:16px;display:inline-block;background:#ebeced;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(1){width:60px;margin-bottom:4px;}.css-jflero .LinkCard-ecommerceLoadingCardLoadingbar span:nth-of-type(2){width:127px;}.css-jflero .LinkCard.new{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:390px;min-height:84px;border-radius:8px;max-width:100%;overflow:hidden;margin:16px auto;padding:12px 12px 9px 12px;background-color:#f8f8fa;}.css-jflero .LinkCard.new,.css-jflero .LinkCard.new:hover{-webkit-text-decoration:none;text-decoration:none;border:none !important;color:inherit !important;}.css-jflero .LinkCard.new .LinkCard-contents{display:block;-webkit-flex:1 1 auto;-ms-flex:1 1 auto;flex:1 1 auto;position:relative;}.css-jflero .LinkCard.new .LinkCard-contents .loading{height:14px;background:#ebeced;border-radius:7px;}.css-jflero .LinkCard.new .LinkCard-contents.withTitle{margin-bottom:3px;}.css-jflero .LinkCard.new .LinkCard-title{display:-webkit-box;font-size:15px;font-weight:500;line-height:1.4;margin-bottom:2px;color:#191B1F;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-jflero .LinkCard.new .LinkCard-title.two-line{line-height:20px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-jflero .LinkCard.new .LinkCard-title.loading{margin-bottom:8px;width:80%;}.css-jflero .LinkCard.new .LinkCard-title.loading.withTitle{margin-bottom:6px;}.css-jflero .LinkCard.new .LinkCard-title.loadingTitle{margin-bottom:5px;}.css-jflero .LinkCard.new .LinkCard-excerpt{display:-webkit-box;text-overflow:ellipsis;font-size:13px;line-height:18px;color:#9196a1;margin-bottom:4px;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-jflero .LinkCard.new .LinkCard-excerpt .LinkCard-author{color:#373a40;}.css-jflero .LinkCard.new .LinkCard-desc{display:-webkit-box;font-size:13px;height:18px;line-height:18px;color:#9196a1;word-break:break-all;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:1;}.css-jflero .LinkCard.new .LinkCard-desc .LinkCard-tag,.css-jflero .LinkCard.new .LinkCard-desc .tag{display:inline-block;font-size:11px;margin-left:8px;padding:0 4px;border-radius:3px;background:rgba(196,199,206,0.3);}.css-jflero .LinkCard.new .LinkCard-desc.loading{width:40%;}.css-jflero .LinkCard.new .LinkCard-desc svg{margin-right:2px;}.css-jflero .LinkCard.new .LinkCard-image{-webkit-flex:0 0 auto;-ms-flex:0 0 auto;flex:0 0 auto;background-color:#ebeced;background-size:cover;background-position:center;position:relative;display:block;width:60px;height:60px;margin-left:20px;object-fit:cover;border-radius:inherit;overflow:hidden;}.css-jflero .LinkCard.new .LinkCard-image.LinkCard-image--default{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;background-color:#ebeced;color:#c4c7ce;}.css-jflero .LinkCard.new .LinkCard-image.LinkCard-image--default svg{color:#9196a1;}.css-jflero .LinkCard.new .LinkCard-image img{width:100%;height:100%;object-fit:cover;}.css-jflero .LinkCard.new .LinkCard-image .LinkCard-image--video{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:24px;height:24px;border-radius:12px;background:rgba(255,255,255,0.9);pointer-events:none;}.css-jflero .LinkCard.new .LinkCard-image .LinkCard-image--video svg{color:#373a40;}.css-jflero .LinkCard.new .LinkCard-richText .text{color:#373a40;}.css-jflero .LinkCard.new .LinkCard-richText .bold{font-weight:600;}.css-jflero .LinkCard.new .LinkCard-richText .tag{margin-left:4px;}.css-jflero .FileLinkCard{-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(248,248,250,0.88);border-radius:12px;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:1em auto;max-width:100%;overflow:hidden;padding:12px;position:relative;width:390px;}.css-jflero .FileLinkCard-icon{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:30px;width:30px;}.css-jflero .FileLinkCard-info{margin-left:12px;}.css-jflero .FileLinkCard-name{color:#191B1F;font-size:15px;font-weight:500;line-height:21px;display:-webkit-box;text-overflow:ellipsis;overflow:hidden;-webkit-box-orient:vertical;-webkit-line-clamp:2;}.css-jflero .FileLinkCard-meta{color:#9196a1;font-size:12px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;line-height:14px;margin-top:5px;}.css-jflero .FileLinkCard-source{white-space:pre;}.css-jflero img[data-uncomfortable]{content:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20344.88888888888886%20194%22%3E%3CforeignObject%20width%3D%22344.88888888888886%22%20height%3D%22194%22%3E%0A%20%20%20%20%20%20%3Cdiv%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%20style%3D%22font-size%3A%2013px%3B%20font-family%3A%20-apple-system%2C%20BlinkMacSystemFont%2C%20Microsoft%20YaHei%2C%20sans-serif%3B%20color%3A%20%23fff%3B%20width%3A100%25%3B%20height%3A194px%3B%22%3E%0A%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22display%3A%20flex%3B%20flex-direction%3A%20column%3B%20align-items%3A%20center%3B%20justify-content%3A%20center%3B%20height%3A%20100%25%3B%22%3E%0A%20%20%20%20%20%20%20%20%20%20%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2218%22%20height%3D%2218%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22currentColor%22%3E%3Cpath%20d%3D%22M8%203.65a7%207%200%2000-1.353.128.65.65%200%2011-.25-1.275A8.3%208.3%200%20018%202.35c2.387%200%204.172.954%205.357%202.125C14.511%205.615%2015.15%207.022%2015.15%208c0%20.621-.257%201.391-.699%202.134a7.076%207.076%200%2001-1.403%201.68l.495.46a.65.65%200%2011-.886.951l-.998-.929a.645.645%200%2001-.104-.097L9.73%2010.501a.647.647%200%2001-.29.301%203.15%203.15%200%2001-4.313-4.094.647.647%200%2001.234-.275L3.908%205.08a5.774%205.774%200%2000-1.283%201.522C2.282%207.198%202.15%207.707%202.15%208c0%20.522.41%201.616%201.407%202.6.965.954%202.43%201.75%204.443%201.75.468%200%20.905-.043%201.311-.12a.65.65%200%2001.243%201.277A8.322%208.322%200%20018%2013.65c-2.387%200-4.172-.954-5.357-2.125C1.49%2010.385.85%208.978.85%208c0-.598.238-1.333.648-2.046A7.054%207.054%200%20012.95%204.188l-.547-.509a.65.65%200%2011.886-.951l8.8%208.194a5.793%205.793%200%20001.244-1.453c.372-.624.516-1.163.516-1.469%200-.522-.41-1.616-1.407-2.6-.965-.954-2.43-1.75-4.443-1.75zM6.29%207.296a1.85%201.85%200%20002.534%202.36l-2.535-2.36zM8%204.85a.65.65%200%20100%201.3%201.85%201.85%200%20011.843%201.694.65.65%200%20101.296-.11A3.15%203.15%200%20008%204.85z%22%20fill-rule%3D%22evenodd%22%20clip-rule%3D%22evenodd%22%3E%3C%2Fpath%3E%3C%2Fsvg%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cdiv%20style%3D%22margin%3A%20.6em%200%201.2em%22%3E%E8%AF%A5%E5%9B%BE%E7%89%87%E6%9C%89%E5%8F%AF%E8%83%BD%E4%BC%9A%E5%BC%95%E8%B5%B7%E4%B8%8D%E9%80%82%3C%2Fdiv%3E%0A%20%20%20%20%20%20%20%20%20%20%3Cbutton%20style%3D%22padding%3A%204px%201em%3B%20font-size%3A%201.1em%3B%20color%3A%20inherit%3B%20background%3A%20none%3B%20border%3A%201px%20solid%20rgba%28255%2C255%2C255%2C.5%29%3B%20border-radius%3A%209999px%3B%22%3E%E7%BB%A7%E7%BB%AD%E6%9F%A5%E7%9C%8B%3C%2Fbutton%3E%0A%20%20%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%20%20%3C%2Fdiv%3E%0A%20%20%20%20%3C%2FforeignObject%3E%3C%2Fsvg%3E);width:100%;height:194px;background:url(https://pic1.zhimg.com/v2-cf70d0759d787c70091857151c1cad4a.jpeg) no-repeat rgba(191,191,191,0.7);background-size:cover;cursor:pointer!important;}.css-jflero img.content_image[data-size="normal"],.css-jflero img.origin_image[data-size="normal"]{width:100%;max-width:100%;}.css-jflero img.content_image[data-size="small"],.css-jflero img.origin_image[data-size="small"]{width:320px;max-width:100%;}@-webkit-keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}@keyframes animation-1yvu044{from{opacity:0;}to{opacity:1;}}</style><div class="RichText ztext Post-RichText css-jflero" options="[object Object]"><p data-first-child data-pid="938TySp3">很多大型项目（例如PyTorch）都采用了ninja作为构建系统的一部分，为了阅读并了解这些大型项目，有必要对ninja有初步理解。</p><h2><b>ninja简单介绍</b></h2><p data-pid="pzbYAFY5"><b><a href="https://link.zhihu.com/?target=https%3A//ninja-build.org/" class=" wrap external" target="_blank" rel="nofollow noreferrer">ninja</a></b>是一种构建工具，用来调用各种工具（代码生成器、编译器、链接器等）来编译大型项目。与<code>cmake</code>/<code>make</code>等工具不同，<code>ninja</code>在设计之初就<b>不是给人写的</b>，只是用于作为其它程序生成的目标。</p><p data-pid="mLLaKSt9"><code>ninja</code>的设计哲学就是<b>避免任何模糊的内容</b>。比如makefile里面可能经常会用<code>dir/*.cpp</code>来表示源文件，但是这需要查询文件系统才能得到具体内容，是一个很慢而且很不确定的操作。<code>ninja</code>把这些模糊的操作都交给元构建系统（meta-build system，例如<code>cmake</code>），只留下真正需要编译的命令。</p><p data-pid="Bz2dJMm_">因此，本质上我们可以认为<code>ninja</code>就是一条一条地列出了具体要执行的命令，然后执行即可。</p><p data-pid="UZMCO8HY"><code>ninja</code>会分析这一系列命令之间的依赖关系，并根据这个依赖关系实现两个重要特点：</p><ul><li data-pid="7tPiiHQX">并行编译：没有依赖的命令可以并行执行。<code>ninja</code>默认使用的并行数为CPU数量，一般不用手动设置并行数，除非想限制<code>ninja</code>使用的CPU数量（例如有其他任务在运行，只让<code>ninja</code>用一半CPU）。</li><li data-pid="SXQMDZu8">增量编译：根据文件的时间戳进行分析，如果某个文件的时间戳发生了改变，则依赖于这个文件的命令以及其他依赖于这个命令的命令都会被重新执行，以此达到增量编译的效果（比如修改了一个文件之后重新编译）。</li></ul><h2><b>ninja 安装方式</b></h2><p data-pid="6pYZe7TP"><code>ninja</code>是一个工具，而且体量很小。各个系统都有相关的安装方法，具体可参见<b><a href="https://link.zhihu.com/?target=https%3A//github.com/ninja-build/ninja/wiki/Pre-built-Ninja-packages" class=" wrap external" target="_blank" rel="nofollow noreferrer">文档</a></b>。总的来说，有三种安装方式：</p><ul><li data-pid="Axj1KBab">系统级安装：例如Ubuntu上面的<code>apt-get install ninja-build</code>、MacOS上面的<code>brew install ninja</code>，安装后<code>ninja</code>就是一个系统命令，类似<code>ls/cat</code>等命令。</li><li data-pid="qDpE9zD0">用户级安装：例如通过<code>pip</code>或者<code>conda</code>都可以安装<code>ninja</code>: <code>conda install ninja</code> / <code>pip install ninja</code></li><li data-pid="xn0xGbw8">自定义安装：在<b><a href="https://link.zhihu.com/?target=https%3A//github.com/ninja-build/ninja/releases" class=" wrap external" target="_blank" rel="nofollow noreferrer">GitHub下载页面</a></b>下载安装包并解压即可，或者下载源码自己编译。</li></ul><p data-pid="xMoTRL82"><code>ninja</code>是个非常小的工具，从下面的下载页面可以看出，整个工具的压缩包也就一两百KB级别。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-693e36980087d96d3f044facc72a6ff7_b.jpg" data-caption="" data-size="normal" data-rawwidth="1786" data-rawheight="750" class="origin_image zh-lightbox-thumb" width="1786" data-original="https://pic4.zhimg.com/v2-693e36980087d96d3f044facc72a6ff7_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1786&#39; height=&#39;750&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1786" data-rawheight="750" class="origin_image zh-lightbox-thumb lazy" width="1786" data-original="https://pic4.zhimg.com/v2-693e36980087d96d3f044facc72a6ff7_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-693e36980087d96d3f044facc72a6ff7_b.jpg" data-original-token="v2-693e36980087d96d3f044facc72a6ff7"/></figure><p data-pid="vxqnSGWA">其实官方只通过GitHub来发布新版本，其它的安装方式都是社区自己搞的。比如<code>pip install ninja</code>，安装的是<code>scikit-build</code>社区维护的 <a href="https://link.zhihu.com/?target=https%3A//github.com/scikit-build/ninja-python-distributions" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/scikit-build</span><span class="invisible">/ninja-python-distributions</span><span class="ellipsis"></span></a> ，他们把<code>ninja</code>包装成了一个<code>pip</code>包。很多人不知道他们下载的不是官方ninja，这个GitHub项目<b>才46个star，但是有二百五十万次下载</b>。<code>conda install ninja</code>也是一个类似的东西。</p><p data-pid="XE3I_SNa">总之，<b>如果需要保证安全，可以通过<code>ninja</code>的GitHub release页面下载；如果图方便，可以用各种社区维护的安装方式</b>。</p><h2><b>理解ninja文件</b></h2><p data-pid="OO6SsAH_"><code>ninja</code>的构建配置文件一般叫<code>build.ninja</code>。虽然我们一般不写它，但是需要大致看懂它，以便调试或者理解构建过程。</p><p data-pid="i-m5DZ95">下面以一个简单的例子来说明常见的<code>ninja</code>配置：</p><p data-pid="42cd9r6E">有两个头文件<code>a1.h</code>和<code>a2.h</code>，分别定义了一个变量<code>a</code>，但是有不同的值：</p><div class="highlight"><pre><code class="language-text">// a1.h
int a = 1;

// a2.h
int a = 2;
</code></pre></div><p data-pid="OBTf1lZz">一份源文件<code>a.cpp</code>里根据宏的不同来包含这两个文件中的某一个：</p><div class="highlight"><pre><code class="language-text">// a.cpp
#include&lt;iostream&gt;

using namespace ::std;

#ifdef USE_A1
#include &#34;a1.h&#34;
#endif

#ifdef USE_A2
#include &#34;a2.h&#34;
#endif

int main()
{
    cout &lt;&lt; &#34;hello, world from &#34; &lt;&lt; a &lt;&lt; &#34;!\n&#34;;
}
</code></pre></div><p data-pid="iLwltlg0">一份<code>build.ninja</code>文件包含<code>ninja</code>的构建配置（<b>注意最后的换行，是必要的</b>）：</p><div class="highlight"><pre><code class="language-text"># build.ninja
cxxflags = -DUSE_A1

rule compile
    description = compile with $cxxflags
    command = g++ -MM -MF $out.d -MT $out $cxxflags $in &amp;&amp; g++ $cxxflags $in -o $out
    depfile = $out.d

build compile_with_default_cxxflags: compile a.cpp

build compile_with_shadow_cxxflags: compile a.cpp
    cxxflags = -DUSE_A2

default compile_with_default_cxxflags

</code></pre></div><p data-pid="Z4DnWL4e">这份配置里包含了以下常见内容：</p><ul><li data-pid="07LrVBgU">注释（comment），<code>build.ninja</code>里用<code>#</code>开头的行表示注释，这个没什么好解释的。</li><li data-pid="UeRHTk1i">变量（variable），<code>cxxflags = -DUSE_A1</code>定义了一个变量<code>cxxflags</code>，其值为<code>-DUSE_A1</code>。这个变量的值在后面的代码中都可以用，引用方式为<code>$cxxflags</code>。具体来说，<code>-DUSE_A1</code>就是在编译之前定义名为<code>USE_A1</code>的宏。</li><li data-pid="64S76W0o">规则（rule），语法为<code>rule </code>加上规则的名字。这里我们定义了一个名为<code>compile</code>的规则。规则内有默认变量<code>$in</code>和<code>$out</code>，<code>$in</code>表示输入文件的列表，<code>$out</code>表示输出文件名。</li><li data-pid="ocC7vt8P">规则的文字描述（description），用于在编译过程中展示并告诉用户目前在干什么。</li><li data-pid="UNXTirrj">规则的具体命令（command），写明具体的编译命令。</li><li data-pid="O4BmxmFn">规则的依赖项记录文件（depfile），用于增量编译，详见后面的解释。</li><li data-pid="E7Kc4OCF">构建（build），语法为<code>build</code>加上构建的文件名，加上冒号<code>:</code>以及规则名、输入文件列表。本质上<code>build $out: $rule $in</code>就是把<code>$in</code>和<code>$out</code>传给<code>$rule</code>，然后运行它的<code>command</code>命令。</li><li data-pid="LCMJacIB">构建里的局部变量，在<code>build</code>下面的任意变量，在本次构建命令中覆盖全局的变量。具体来说，<code>build compile_with_shadow_cxxflags</code>里定义的<code>cxxflags</code>会覆盖本次<code>compile</code>命令用到的<code>cxxflags</code>。</li><li data-pid="eJI8juTp">默认构建目标（default）。可以存在多行<code>default</code>，最后的默认构建目标就是它们的并集。如果没有任何<code>default</code>，则默认构建全部的<code>build</code>条目。</li></ul><p data-pid="uhi0WOsv">有了这份<code>build.ninja</code>，我们可以通过<code>ninja</code>或者<code>ninja compile_with_default_cxxflags</code>来构建默认的代码，得到可执行文件<code>compile_with_default_cxxflags</code>（执行后输出<code>hello, world from 1!</code>）；也可以通过<code>ninja compile_with_shadow_cxxflags</code>得到可执行文件<code>compile_with_shadow_cxxflags</code>（执行后输出<code>hello, world from 2!</code>）。我们也可以修改<code>a1.h</code>或者<code>a2.h</code>，观察<code>ninja</code>是否会重新编译。</p><h2><b>理解<code>ninja</code>的增量编译</b></h2><p data-pid="MaUDS_zY">这份<code>build.ninja</code>里的大部分内容简单易懂，唯一难以理解的就是用于增量编译的<code>depfile = $out.d</code>。</p><p data-pid="TwP93OQM">首先，<code>$out</code>是<code>ninja</code>的默认变量，表示构建的目标文件名。所以<code>$out.d</code>就是目标文件名加上<code>.d</code>。比如<code>build compile_with_default_cxxflags</code>里，<code>depfile</code>就是<code>compile_with_default_cxxflags.d</code>。</p><p data-pid="HBXAFqyP">然后我们需要理解增量构建的目标：我们的<code>build compile_with_default_cxxflags</code>构建条目中，只传入了<code>a.cpp</code>这一个文件，但是实际上我们的代码里面包含了<code>a1.h</code>或者<code>a2.h</code>。如何能够让<code>ninja</code>知道增量构建的时候需要检查<code>a1.h</code>或者<code>a2.h</code>呢？这就需要编译器的支持了：<code>g++</code>的<code>-MM -MF $out.d</code>参数会将文件与头文件的依赖关系输出到<code>$out.d</code>中，下次<code>ninja</code>就会通过这个文件的内容来判断具体需要检查发生改变的文件。</p><p data-pid="fYhhJr39">例如，<code>compile_with_default_cxxflags.d</code>文件里，就有以下内容：</p><div class="highlight"><pre><code class="language-text">compile_with_default_cxxflags: a.cpp a1.h

</code></pre></div><p data-pid="Ttzkf6U6">下次<code>ninja</code>再<code>build compile_with_default_cxxflags</code>的时候，就会检查这个文件，然后查看<code>a.cpp</code>与<code>a1.h</code>的修改时间，如果任何一个文件被修改了，就重新编译。另外，如果<code>compile_with_default_cxxflags</code>文件不在了，<code>ninja</code>也会重新编译（这个很好理解）。</p><h2><b><code>ninja</code>进阶用法</b></h2><p data-pid="dMrzy8_Q">很多<code>ninja.build</code>里存在<code>phony</code>规则。这是一个内置规则，意思是“假冒的”，就是一个不存在规则的规则。我们可以理解为：</p><div class="highlight"><pre><code class="language-text">rule phony
    command = : $in $out
</code></pre></div><p data-pid="g0Cu6Tfc">其中冒号<code>:</code>是unix系统里的一个命令，不管参数是什么，永远正常退出。因此，<code>phony</code>规则不会做什么，但是<b>会在输入和输出之间建立依赖关系</b>。</p><p data-pid="M8oLUgO4">不带参数的<code>ninja</code>命令会构建文件里的<code>default</code>构建目标。我们也可以用<code>ninja compile_with_shadow_cxxflags</code>来手动构建某个目标。</p><p data-pid="Zo3gpAkp">构建多个目标（比如PyTorch有上千个目标）的时候，<code>ninja</code>会展示一个进度条，进度条展现的内容就是<code>rule</code>下面的<code>description</code>字段的内容。</p><p data-pid="EJOVTqZp"><code>ninja</code>的高级用法一般都在<code>ninja -t</code>下面，例如<code>ninja -t clean</code>可以清理全部生成文件、<code>ninja -t browse</code>可以打开一个网页浏览器查看文件之间的依赖图（默认查看的是名为<code>all</code>的依赖图）：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-d69b6f0baa79bc67a3ffea047c3d677c_b.jpg" data-caption="" data-size="normal" data-rawwidth="1102" data-rawheight="756" class="origin_image zh-lightbox-thumb" width="1102" data-original="https://pic1.zhimg.com/v2-d69b6f0baa79bc67a3ffea047c3d677c_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;1102&#39; height=&#39;756&#39;&gt;&lt;/svg&gt;" data-caption="" data-size="normal" data-rawwidth="1102" data-rawheight="756" class="origin_image zh-lightbox-thumb lazy" width="1102" data-original="https://pic1.zhimg.com/v2-d69b6f0baa79bc67a3ffea047c3d677c_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-d69b6f0baa79bc67a3ffea047c3d677c_b.jpg" data-original-token="v2-d69b6f0baa79bc67a3ffea047c3d677c"/></figure><p data-pid="tOuSObFB">通过这个浏览器界面，我们可以很方便地查看什么文件依赖于什么文件。打开<code>http://localhost:8000/?libtorch.so</code>就可以看到完整的<code>libtorch.so</code>对应的依赖，再也不用对着<code>CMakeLists.txt</code>瞎猜了。（还可以通过<code>ninja -t graph</code>直接导出依赖图的dot graph文件，但是大型项目的依赖图一般都非常复杂，看起来不方便。）</p><p data-pid="WSlFAZWC">最后，<code>ninja -t targets all</code>得到的是全部的构建目标，可以用于<code>grep</code>搜索想要的内容；<code>ninja -C /path/to/dir -f /path/to/file</code>可以让<code>ninja</code>切换到<code>/path/to/dir</code>去执行命令、并读取<code>/path/to/file</code>配置文件来执行。<code>-f</code>的默认参数是<code>build.ninja</code>，<code>-C</code>的默认参数为<code>.</code>，也就是当前路径。一般来说<code>-f</code>参数用得很少，<code>-C</code>参数用得比较多。</p><h2><b>总结</b></h2><p data-pid="pouxidef">本文简单介绍了<code>ninja</code>的一些原理及用法。虽然简单，但依然起了个“一文读懂ninja构建系统”的标题，就是因为<code>ninja</code>真的很小，它的<b><a href="https://link.zhihu.com/?target=https%3A//ninja-build.org/manual.html" class=" wrap external" target="_blank" rel="nofollow noreferrer">全部文档</a></b>差不多也就这些值得我们关心的内容。</p></div></div></div></div><div role="button" tabindex="0" class="ContentItem-time">发布于 2024-01-08 21:23<!-- -->・IP 属地北京</div><div class="Post-topicsAndReviewer"><div class="TopicList Post-Topics"><style data-emotion-css="ch8ocw">.css-ch8ocw{position:relative;display:inline-block;height:30px;padding:0 12px;font-size:14px;line-height:30px;color:#1772F6;vertical-align:top;border-radius:100px;background:rgba(23,114,246,0.1);}.css-ch8ocw:hover{background-color:rgba(23,114,246,0.15);}</style><div class="Tag Topic css-ch8ocw"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19834837" target="_blank"><style data-emotion-css="1xlfegr">.css-1xlfegr{background:transparent;box-shadow:none;}</style><style data-emotion-css="1gomreu">.css-1gomreu{position:relative;display:inline-block;}</style><div class="css-1gomreu">CMake</div></a></span></div><div class="Tag Topic css-ch8ocw"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/20075993" target="_blank"><div class="css-1gomreu">PyTorch</div></a></span></div><div class="Tag Topic css-ch8ocw"><span class="Tag-content"><a class="TopicLink" href="//www.zhihu.com/topic/19601705" target="_blank"><div class="css-1gomreu">C / C++</div></a></span></div></div></div><div><div class="Sticky RichContent-actions is-bottom"><div class="ContentItem-actions"><span><button aria-label="赞同 74 " aria-live="polite" type="button" class="Button VoteButton VoteButton--up FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleUp VoteButton-TriangleUp" fill="currentColor"><path fill-rule="evenodd" d="M13.792 3.681c-.781-1.406-2.803-1.406-3.584 0l-7.79 14.023c-.76 1.367.228 3.046 1.791 3.046h15.582c1.563 0 2.55-1.68 1.791-3.046l-7.79-14.023Z" clip-rule="evenodd"></path></svg></span>赞同 74</button><button aria-label="反对" aria-live="polite" type="button" class="Button VoteButton VoteButton--down FEfUrdfMIKpQDJDqkjte"><span style="display:inline-flex;align-items:center">​<svg width="10" height="10" viewBox="0 0 24 24" class="Zi Zi--TriangleDown" fill="currentColor"><path fill-rule="evenodd" d="M13.792 20.319c-.781 1.406-2.803 1.406-3.584 0L2.418 6.296c-.76-1.367.228-3.046 1.791-3.046h15.582c1.563 0 2.55 1.68 1.791 3.046l-7.79 14.023Z" clip-rule="evenodd"></path></svg></span></button></span><button type="button" class="Button BottomActions-CommentBtn FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Comment Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path fill-rule="evenodd" d="M12 2.75a9.25 9.25 0 1 0 4.737 17.197l2.643.817a1 1 0 0 0 1.25-1.25l-.8-2.588A9.25 9.25 0 0 0 12 2.75Z" clip-rule="evenodd"></path></svg></span>2 条评论</button><div class="Popover ShareMenu"><div class="ShareMenu-toggler" id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Share Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M19.47 1.914a.8.8 0 0 1 1.204.778l-1.872 16.386a.9.9 0 0 1-1.204.743l-4.615-1.692a.7.7 0 0 0-.831.28l-1.927 3.02c-.43.674-1.474.369-1.474-.43v-3.865a.8.8 0 0 1 .179-.504l5.808-7.148a.595.595 0 0 0-.897-.781l-5.93 6.354a1.1 1.1 0 0 1-1.258.252L2.57 13.46a.8.8 0 0 1-.08-1.415l16.98-10.13Z"></path></svg></span>分享</button></div></div><button aria-live="polite" type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Heart Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path fill-rule="evenodd" d="M12.004 4.934c1.015-.944 2.484-1.618 3.98-1.618 3.48 0 6.53 3.265 6.15 7.614-.11 1.254-.686 2.55-1.458 3.753-.778 1.215-1.79 2.392-2.845 3.419-1.054 1.028-2.168 1.923-3.161 2.566a9.96 9.96 0 0 1-1.41.777c-.418.182-.862.32-1.268.32s-.848-.137-1.267-.317a9.918 9.918 0 0 1-1.407-.771c-.992-.64-2.103-1.53-3.156-2.555-1.052-1.024-2.062-2.2-2.84-3.417-.77-1.208-1.346-2.51-1.456-3.775-.38-4.349 2.67-7.614 6.15-7.614 1.484 0 2.983.673 3.988 1.618Z" clip-rule="evenodd"></path></svg></span>喜欢</button><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Star Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M10.484 3.307c.673-1.168 2.358-1.168 3.032 0l2.377 4.122a.25.25 0 0 0 .165.12l4.655.987c1.319.28 1.84 1.882.937 2.884l-3.186 3.535a.25.25 0 0 0-.063.193l.5 4.733c.142 1.34-1.222 2.33-2.453 1.782l-4.346-1.938a.25.25 0 0 0-.204 0l-4.346 1.938c-1.231.549-2.595-.442-2.453-1.782l.5-4.733a.25.25 0 0 0-.064-.193L2.35 11.42c-.903-1.002-.382-2.604.937-2.884l4.655-.987a.25.25 0 0 0 .164-.12l2.378-4.122Z"></path></svg></span>收藏</button><button type="button" class="Button ContentItem-action FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--withLabel fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY RuuQ6TOh2cRzJr6WlyQp"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Deliver Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><g fill-rule="evenodd" clip-rule="evenodd"><path d="M7.821 12a.75.75 0 0 1 .75-.75h6.857a.75.75 0 0 1 0 1.5H8.571a.75.75 0 0 1-.75-.75ZM8.965 8a.75.75 0 0 1 .75-.75h4.571a.75.75 0 0 1 0 1.5H9.715a.75.75 0 0 1-.75-.75Z"></path><path d="M7.527 3.15a2.35 2.35 0 0 0-2.309 1.91L3.165 15.84a.85.85 0 0 0-.015.16v2.5a2.35 2.35 0 0 0 2.35 2.35h13a2.35 2.35 0 0 0 2.35-2.35V16a.848.848 0 0 0-.015-.16L18.78 5.06a2.35 2.35 0 0 0-2.308-1.91H7.527Zm0 1.7a.65.65 0 0 0-.639.528l-1.88 9.872h13.984l-1.88-9.872a.65.65 0 0 0-.64-.528H7.528Z"></path></g></svg></span>申请转载</button><div class="Post-ActionMenuButton"><div class="Popover"><div id="null-toggle" aria-haspopup="true" aria-expanded="false" aria-owns="null-content"><button type="button" class="Button FEfUrdfMIKpQDJDqkjte Button--plain Button--withIcon Button--iconOnly fEPKGkUK5jyc4fUuT0QP B46v1Ak6Gj5sL2JTS4PY hIwDV_tcL6XN1HprrnAq"><span style="display:inline-flex;align-items:center">​<svg width="1.2em" height="1.2em" viewBox="0 0 24 24" class="Zi Zi--Dots Button-zi t2ntD6J1DemdOdvh5FB4" fill="currentColor"><path d="M6 10.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3ZM10.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0ZM16.5 12a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z"></path></svg></span></button></div></div></div></div></div></div></article><div class="Post-Sub Post-NormalSub"></div></div></main></div></div><script id="js-clientConfig" type="text/json">{"fetchRoot":{"www":"https:\u002F\u002Fwww.zhihu.com","api":"https:\u002F\u002Fapi.zhihu.com","lens":"https:\u002F\u002Flens.zhihu.com","zhuanlan":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fapi\u002F","walletpay":"https:\u002F\u002Fwalletpay.zhihu.com","captcha":"https:\u002F\u002Fcaptcha.zhihu.com","vzuu":"https:\u002F\u002Fv.vzuu.com","openapi":"https:\u002F\u002Fopenapi.zhihu.com","svip":"https:\u002F\u002Fsvip.zhihu.com"},"host":"zhihu.com","protocol":"https:","wwwHost":"www.zhihu.com","videoHost":"video.zhihu.com","zhuanlanHost":"zhuanlan.zhihu.com","allowSignUp":true,"refreshValidityPeriod":"30","release":"1179-c59a44b3","currentEntry":"column","isMobileEntry":false,"apollo":{"env":"prod","globalSilence":"","ncgModeSign":"3f8e56febda4fb3bbea72e379d76de1e","topstory_rec_adp":"1","topstory_hot_adp":"1","editor_adapt_native":"0","enable_request_filter":"1","content_publish_pin":"0","content_publish_answer":"0","content_publish_question":"1","content_publish_article":"1","content_publish_zvideo":"1","test_canary":"member|0-100,1-0","use_new_player":"member|0-100,1-0","player_vendor":"member|0-100,1-0,2-0","use_hevc":"member|0-0,1-100","upload_use_signature":"member|0-0,1-100","use_backdrop_blur":"member|0-0,1-100","article_title_imagex":"member|0-0,1-100","play_station":"member|0-0,1-100","use_cached_supported_countries":"device|1-100,0-0","contentItem_cover_imagex":"member|0-0,1-100","use_qrcode_login_v2":"device|1-100,0-0","balanceModalSign":"ChYHAcB5ihJECkAFnhDAYmdhsTWVJoNc"}}</script><script id="js-initialData" type="text/json">{"initialState":{"common":{"ask":{},"cities":{"cityData":[]}},"loading":{"global":{"count":0},"local":{"env\u002FgetIpinfo\u002F":false,"article\u002Fget\u002F":false,"brand\u002FgetUrl\u002F":false,"article\u002FloadPostSearchEntity\u002F":false}},"entities":{"users":{"b9aa258fe18286f8cbede71553d2ffee":{"uid":1223272689789718500,"userType":"people","id":"b9aa258fe18286f8cbede71553d2ffee"},"youkaichao":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-4cd09992e39c66a3a177e6fd07e7cecf.jpg?source=172ae18b","uid":"674728182020706304","userType":"people","isFollowing":false,"urlToken":"youkaichao","id":"176cf88046a1cae595b55e12d58c95e9","description":"私信不看，有事请邮件联系 youkaichao@gmail.com\n个人主页：https:\u002F\u002Fyoukaichao.github.io","name":"游凯超","isAdvertiser":false,"headline":"清华软件学院博士研究生，人工智能\u002F机器学习\u002F迁移学习","gender":1,"url":"\u002Fpeople\u002F176cf88046a1cae595b55e12d58c95e9","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-4cd09992e39c66a3a177e6fd07e7cecf_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[{"type":"best_answerer","topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19813032","type":"topic","id":"19813032","name":"深度学习（Deep Learning）"}],"description":"优秀答主"}],"badgeV2":{"title":"深度学习（Deep Learning）话题下的优秀答主","mergedBadges":[{"type":"best","detailType":"best","title":"优秀答主","description":"深度学习（Deep Learning）话题下的优秀答主","url":"https:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F48509984","sources":[{"id":"19813032","token":"19813032","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19813032","name":"深度学习（Deep Learning）","avatarPath":"v2-b708e5dad1a3b4230c035e34e5c35e59","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b708e5dad1a3b4230c035e34e5c35e59_720w.jpg?source=32738c0c","description":"","priority":0}],"icon":"","nightIcon":""}],"detailBadges":[{"type":"best","detailType":"best_answerer","title":"优秀答主","description":"深度学习（Deep Learning）话题下的优秀答主","url":"https:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F48509984","sources":[{"id":"19813032","token":"19813032","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19813032","name":"深度学习（Deep Learning）","avatarPath":"v2-b708e5dad1a3b4230c035e34e5c35e59","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b708e5dad1a3b4230c035e34e5c35e59_720w.jpg?source=32738c0c","description":"","priority":0}],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a07bc69c4bb04444721f35b32125c75_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a07bc69c4bb04444721f35b32125c75_l.png?source=32738c0c"}],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a07bc69c4bb04444721f35b32125c75_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-4a07bc69c4bb04444721f35b32125c75_l.png?source=32738c0c"},"exposedMedal":{"medalId":"972466021521641472","medalName":"优秀答主","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-b9c90b8615a3f2e45b30d4e33d1f6e7b_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b9c90b8615a3f2e45b30d4e33d1f6e7b_l.png?source=172ae18b","description":"成为「优秀答主」即可获得","medalAvatarFrame":""}}},"questions":{},"answers":{},"articles":{"676733751":{"trackUrl":["https:\u002F\u002Fsugar.zhihu.com\u002Fplutus_adreaper\u002Fcontent_monitor_log?si=__SESSIONID__&ti=__ATOKEN__&at=view&pf=__OS__&ed=BiBUKF0xBSkqGGZUBGB9CF52C3vhIlvSj1SQ&idfa=__IDFA__&imei=__IMEI__&androidid=__ANDROIDID__&oaid=__OAID__&ci=__CREATIVEID__&zid=__ZONEID__"],"entityWords":[{"name":"网页浏览器","mention":"网页浏览器","matchorder":1,"begin":8464,"end":8469,"entityid":4356661300049361400,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0005353026731679394,"attachedInfoBytes":"sgJiCg\u002FnvZHpobXmtY\u002Fop4jlmagSB1Vua25vd24YkEIglUIoATWOUww6OgdhcnRpY2xlQMTziOHqi\u002F66PEgAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2byAuEBCiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2YaB2FydGljbGUiCTIzODUxNTQzMDoP572R6aG15rWP6KeI5ZmoQMTziOHqi\u002F66PEgAUh9uZXdfYmFpZHUtd2lraXBlZGlhLWl0ZW0tcmVjYWxsXY5TDDpiYgoP572R6aG15rWP6KeI5ZmoEgdVbmtub3duGJBCIJVCKAE1jlMMOjoHYXJ0aWNsZUDE84jh6ov+ujxIAFIkOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdm","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"ninja配置","mention":"ninja配置","matchorder":1,"begin":1326,"end":1333,"entityid":4573774706572101600,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0007323749245973232,"attachedInfoBytes":"sgJbCgtuaW5qYemFjee9rhIETWF0aBiuCiC1CigBNdn8Pzo6B2FydGljbGVAzo+W383707w\u002FSABSJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZvICyQEKJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZhoHYXJ0aWNsZSIJMjM4NTE1NDMwOgtuaW5qYemFjee9rkDOj5bfzfvTvD9IA1ISYWlfZW50aXR5X3JlY2FsbGVyXdn8PzpiWwoLbmluamHphY3nva4SBE1hdGgYrgogtQooATXZ\u002FD86OgdhcnRpY2xlQM6Plt\u002FN+9O8P0gAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2Y=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"command命令","mention":"command命令","matchorder":1,"begin":2478,"end":2487,"entityid":-3998405542623791000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.000652945525801224,"attachedInfoBytes":"sgJeCg1jb21tYW5k5ZG95LukEgRNYXRoGK4TILcTKAE1byorOjoHYXJ0aWNsZUDH8NLf\u002FuqzwcgBSABSJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZvICzwEKJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZhoHYXJ0aWNsZSIJMjM4NTE1NDMwOg1jb21tYW5k5ZG95LukQMfw0t\u002F+6rPByAFIBFISYWlfZW50aXR5X3JlY2FsbGVyXW8qKzpiXgoNY29tbWFuZOWRveS7pBIETWF0aBiuEyC3EygBNW8qKzo6B2FydGljbGVAx\u002FDS3\u002F7qs8HIAUgAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2Y=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"代码生成器","mention":"代码生成器","matchorder":1,"begin":307,"end":312,"entityid":3142504023505959000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0005834158248953919,"attachedInfoBytes":"sgJiCg\u002Fku6PnoIHnlJ\u002FmiJDlmagSB1Vua25vd24YswIguAIoATVg8Bg6OgdhcnRpY2xlQKfwu9Kn2JrOK0gAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2byAuEBCiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2YaB2FydGljbGUiCTIzODUxNTQzMDoP5Luj56CB55Sf5oiQ5ZmoQKfwu9Kn2JrOK0gFUh9uZXdfYmFpZHUtd2lraXBlZGlhLWl0ZW0tcmVjYWxsXWDwGDpiYgoP5Luj56CB55Sf5oiQ5ZmoEgdVbmtub3duGLMCILgCKAE1YPAYOjoHYXJ0aWNsZUCn8LvSp9iazitIAFIkOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdm","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"phony规则","mention":"phony规则","matchorder":2,"begin":3774,"end":3781,"entityid":944639609714440200,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.000554988050218766,"attachedInfoBytes":"sgJbCgtwaG9ueeinhOWImRIETWF0aBi+HSDFHSgCNZ58ETo6B2FydGljbGVA5O+rzoWXgo4NSABSJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZvICyQEKJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZhoHYXJ0aWNsZSIJMjM4NTE1NDMwOgtwaG9ueeinhOWImUDk76vOhZeCjg1IBlISYWlfZW50aXR5X3JlY2FsbGVyXZ58ETpiWwoLcGhvbnnop4TliJkSBE1hdGgYvh0gxR0oAjWefBE6OgdhcnRpY2xlQOTvq86Fl4KODUgAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2Y=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"compile命令","mention":"compile命令","matchorder":1,"begin":2584,"end":2593,"entityid":7714550842825555000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0007083748632385756,"attachedInfoBytes":"sgJdCg1jb21waWxl5ZG95LukEgRNYXRoGJgUIKEUKAE1O7I5OjoHYXJ0aWNsZUDL9Lri4+Plh2tIAFIkOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdm8gLNAQokOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdmGgdhcnRpY2xlIgkyMzg1MTU0MzA6DWNvbXBpbGXlkb3ku6RAy\u002FS64uPj5YdrSAdSEmFpX2VudGl0eV9yZWNhbGxlcl07sjk6Yl0KDWNvbXBpbGXlkb3ku6QSBE1hdGgYmBQgoRQoATU7sjk6OgdhcnRpY2xlQMv0uuLj4+WHa0gAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2Y=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"t clean","mention":"t clean","matchorder":1,"begin":8405,"end":8412,"entityid":7077090857672905000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Commodity","score":0.0005768672519665952,"attachedInfoBytes":"sgJcCgd0IGNsZWFuEglDb21tb2RpdHkY1UEg3EEoATXoOBc6OgdhcnRpY2xlQLeciLa5lLibYkgAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2byAsYBCiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2YaB2FydGljbGUiCTIzODUxNTQzMDoHdCBjbGVhbkC3nIi2uZS4m2JICFISYWlfZW50aXR5X3JlY2FsbGVyXeg4FzpiXAoHdCBjbGVhbhIJQ29tbW9kaXR5GNVBINxBKAE16DgXOjoHYXJ0aWNsZUC3nIi2uZS4m2JIAFIkOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdm","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"源文件","mention":"源文件","matchorder":1,"begin":539,"end":542,"entityid":-1857418622950463200,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Unknown","score":0.0005100570987003222,"attachedInfoBytes":"sgJdCgnmupDmlofku7YSB1Vua25vd24YmwQgngQoATVatQU6OgdhcnRpY2xlQKHS3t6n88ec5gFIAFIkOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdm8gLXAQokOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdmGgdhcnRpY2xlIgkyMzg1MTU0MzA6Cea6kOaWh+S7tkCh0t7ep\u002FPHnOYBSAlSH25ld19iYWlkdS13aWtpcGVkaWEtaXRlbS1yZWNhbGxdWrUFOmJdCgnmupDmlofku7YSB1Vua25vd24YmwQgngQoATVatQU6OgdhcnRpY2xlQKHS3t6n88ec5gFIAFIkOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdm","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"apt-get install ninja-build","mention":"apt-get install ninja-build","matchorder":1,"begin":1487,"end":1514,"entityid":-2261773167842325500,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Commodity","score":0.0021296153768410875,"attachedInfoBytes":"sgJxChthcHQtZ2V0IGluc3RhbGwgbmluamEtYnVpbGQSCUNvbW1vZGl0eRjPCyDqCygBNQSRCzs6B2FydGljbGVAyZj+wZippM7gAUgAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2byAvABCiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2YaB2FydGljbGUiCTIzODUxNTQzMDobYXB0LWdldCBpbnN0YWxsIG5pbmphLWJ1aWxkQMmY\u002FsGYqaTO4AFIClISYWlfZW50aXR5X3JlY2FsbGVyXQSRCzticQobYXB0LWdldCBpbnN0YWxsIG5pbmphLWJ1aWxkEglDb21tb2RpdHkYzwsg6gsoATUEkQs7OgdhcnRpY2xlQMmY\u002FsGYqaTO4AFIAFIkOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdm","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"depfile","mention":"depfile","matchorder":4,"begin":4379,"end":4386,"entityid":1897013383861642200,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"OtherTerm","score":0.0005521889275532932,"attachedInfoBytes":"sgJcCgdkZXBmaWxlEglPdGhlclRlcm0YmyIgoiIoBDXGwBA6OgdhcnRpY2xlQOXI8Pny8+KpGkgAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2byAsYBCiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2YaB2FydGljbGUiCTIzODUxNTQzMDoHZGVwZmlsZUDlyPD58vPiqRpIDVISYWlfZW50aXR5X3JlY2FsbGVyXcbAEDpiXAoHZGVwZmlsZRIJT3RoZXJUZXJtGJsiIKIiKAQ1xsAQOjoHYXJ0aWNsZUDlyPD58vPiqRpIAFIkOTdmN2Y0YmQtNmMwZi00MjEyLWFjZjctZWQwNzJjNWQ1ZDdm","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"增量编译","mention":"增量编译","matchorder":1,"begin":1025,"end":1029,"entityid":-1191010530113234400,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0.0005339431394058847,"attachedInfoBytes":"sgJhCgzlop7ph4\u002FnvJbor5ESCENvbXB1dGVyGIEIIIUIKAE1UfgLOjoHYXJ0aWNsZUDhtOfmuservO8BSABSJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZvIC0QEKJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZhoHYXJ0aWNsZSIJMjM4NTE1NDMwOgzlop7ph4\u002FnvJbor5FA4bTn5rrHq7zvAUgOUhJhaV9lbnRpdHlfcmVjYWxsZXJdUfgLOmJhCgzlop7ph4\u002FnvJbor5ESCENvbXB1dGVyGIEIIIUIKAE1UfgLOjoHYXJ0aWNsZUDhtOfmuservO8BSABSJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3Zg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"ninja命令","mention":"ninja命令","matchorder":1,"begin":3811,"end":3818,"entityid":4046515176664116700,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Computer","score":0.0007405761501672048,"attachedInfoBytes":"sgJfCgtuaW5qYeWRveS7pBIIQ29tcHV0ZXIY4x0g6h0oATU5I0I6OgdhcnRpY2xlQM3bqprSg4eUOEgAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2byAs0BCiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2YaB2FydGljbGUiCTIzODUxNTQzMDoLbmluamHlkb3ku6RAzduqmtKDh5Q4SBBSEmFpX2VudGl0eV9yZWNhbGxlcl05I0I6Yl8KC25pbmph5ZG95LukEghDb21wdXRlchjjHSDqHSgBNTkjQjo6B2FydGljbGVAzduqmtKDh5Q4SABSJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3Zg==","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""},{"name":"libtorch.so","mention":"libtorch.so","matchorder":1,"begin":8981,"end":8992,"entityid":6229557942530915000,"isBookMark":false,"link":{"linkType":0,"linkUrl":"","docType":"","topicToken":""},"entityClass":"Math","score":0.0007163081882780864,"attachedInfoBytes":"sgJbCgtsaWJ0b3JjaC5zbxIETWF0aBiVRiCgRigBNaHGOzo6B2FydGljbGVApviSgpe+9blWSABSJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZvICyQEKJDk3ZjdmNGJkLTZjMGYtNDIxMi1hY2Y3LWVkMDcyYzVkNWQ3ZhoHYXJ0aWNsZSIJMjM4NTE1NDMwOgtsaWJ0b3JjaC5zb0Cm+JKCl771uVZIEVISYWlfZW50aXR5X3JlY2FsbGVyXaHGOzpiWwoLbGlidG9yY2guc28SBE1hdGgYlUYgoEYoATWhxjs6OgdhcnRpY2xlQKb4koKXvvW5VkgAUiQ5N2Y3ZjRiZC02YzBmLTQyMTItYWNmNy1lZDA3MmM1ZDVkN2Y=","isOnAB":false,"isNatural":1,"isDelete":false,"contentType":"","contentId":"","contentToken":""}],"id":676733751,"title":"一文读懂ninja构建系统","type":"article","articleType":"normal","excerptTitle":"","url":"https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F676733751","imageUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-61b13975832b12bc4f988961e5557af6_720w.jpg?source=172ae18b","titleImage":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-61b13975832b12bc4f988961e5557af6_720w.jpg?source=172ae18b","excerpt":"\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-693e36980087d96d3f044facc72a6ff7_200x112.png\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1786\" data-rawheight=\"750\" data-watermark=\"original\" data-original-src=\"v2-693e36980087d96d3f044facc72a6ff7\" data-watermark-src=\"v2-95a1260e0d48fda7940e1b69932b60c6\" data-private-watermark-src=\"\" class=\"origin_image inline-img zh-lightbox-thumb\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-693e36980087d96d3f044facc72a6ff7_r.png\"\u002F\u003E很多大型项目（例如PyTorch）都采用了ninja作为构建系统的一部分，为了阅读并了解这些大型项目，有必要对ninja有初步理解。 \u003Cb\u003Eninja简单介绍\u003C\u002Fb\u003E \u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fninja-build.org\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Eninja\u003C\u002Fa\u003E\u003C\u002Fb\u003E是一种构建工具，用来调用各种工具（代码生成器、编译器、链接器等）来编译大型项目。与cmake\u002Fmake等工具不同…","created":1704720195,"updated":1704720195,"author":{"isFollowed":false,"avatarUrlTemplate":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-4cd09992e39c66a3a177e6fd07e7cecf.jpg?source=172ae18b","uid":"674728182020706304","userType":"people","isFollowing":false,"urlToken":"youkaichao","id":"176cf88046a1cae595b55e12d58c95e9","description":"私信不看，有事请邮件联系 youkaichao@gmail.com\n个人主页：https:\u002F\u002Fyoukaichao.github.io","name":"游凯超","isAdvertiser":false,"headline":"清华软件学院博士研究生，人工智能\u002F机器学习\u002F迁移学习","gender":1,"url":"\u002Fpeople\u002F176cf88046a1cae595b55e12d58c95e9","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-4cd09992e39c66a3a177e6fd07e7cecf_l.jpg?source=172ae18b","isOrg":false,"type":"people","badge":[{"type":"best_answerer","topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19813032","type":"topic","id":"19813032","name":"深度学习（Deep Learning）"}],"description":"优秀答主"}],"badgeV2":{"title":"深度学习（Deep Learning）话题下的优秀答主","mergedBadges":[{"type":"best","detailType":"best","title":"优秀答主","description":"深度学习（Deep Learning）话题下的优秀答主","url":"https:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F48509984","sources":[{"id":"19813032","token":"19813032","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19813032","name":"深度学习（Deep Learning）","avatarPath":"v2-b708e5dad1a3b4230c035e34e5c35e59","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b708e5dad1a3b4230c035e34e5c35e59_720w.jpg?source=32738c0c","description":"","priority":0}],"icon":"","nightIcon":""}],"detailBadges":[{"type":"best","detailType":"best_answerer","title":"优秀答主","description":"深度学习（Deep Learning）话题下的优秀答主","url":"https:\u002F\u002Fwww.zhihu.com\u002Fquestion\u002F48509984","sources":[{"id":"19813032","token":"19813032","type":"topic","url":"https:\u002F\u002Fwww.zhihu.com\u002Ftopic\u002F19813032","name":"深度学习（Deep Learning）","avatarPath":"v2-b708e5dad1a3b4230c035e34e5c35e59","avatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b708e5dad1a3b4230c035e34e5c35e59_720w.jpg?source=32738c0c","description":"","priority":0}],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a07bc69c4bb04444721f35b32125c75_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a07bc69c4bb04444721f35b32125c75_l.png?source=32738c0c"}],"icon":"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-4a07bc69c4bb04444721f35b32125c75_l.png?source=32738c0c","nightIcon":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-4a07bc69c4bb04444721f35b32125c75_l.png?source=32738c0c"},"exposedMedal":{"medalId":"972466021521641472","medalName":"优秀答主","avatarUrl":"https:\u002F\u002Fpica.zhimg.com\u002Fv2-b9c90b8615a3f2e45b30d4e33d1f6e7b_r.png?source=172ae18b","miniAvatarUrl":"https:\u002F\u002Fpicx.zhimg.com\u002Fv2-b9c90b8615a3f2e45b30d4e33d1f6e7b_l.png?source=172ae18b","description":"成为「优秀答主」即可获得","medalAvatarFrame":""}},"commentPermission":"all","copyrightPermission":"need_review","state":"published","ipInfo":"IP 属地北京","imageWidth":846,"imageHeight":345,"content":"\u003Cp data-pid=\"938TySp3\"\u003E很多大型项目（例如PyTorch）都采用了ninja作为构建系统的一部分，为了阅读并了解这些大型项目，有必要对ninja有初步理解。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003Eninja简单介绍\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"pzbYAFY5\"\u003E\u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fninja-build.org\u002F\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003Eninja\u003C\u002Fa\u003E\u003C\u002Fb\u003E是一种构建工具，用来调用各种工具（代码生成器、编译器、链接器等）来编译大型项目。与\u003Ccode\u003Ecmake\u003C\u002Fcode\u003E\u002F\u003Ccode\u003Emake\u003C\u002Fcode\u003E等工具不同，\u003Ccode\u003Eninja\u003C\u002Fcode\u003E在设计之初就\u003Cb\u003E不是给人写的\u003C\u002Fb\u003E，只是用于作为其它程序生成的目标。\u003C\u002Fp\u003E\u003Cp data-pid=\"mLLaKSt9\"\u003E\u003Ccode\u003Eninja\u003C\u002Fcode\u003E的设计哲学就是\u003Cb\u003E避免任何模糊的内容\u003C\u002Fb\u003E。比如makefile里面可能经常会用\u003Ccode\u003Edir\u002F*.cpp\u003C\u002Fcode\u003E来表示源文件，但是这需要查询文件系统才能得到具体内容，是一个很慢而且很不确定的操作。\u003Ccode\u003Eninja\u003C\u002Fcode\u003E把这些模糊的操作都交给元构建系统（meta-build system，例如\u003Ccode\u003Ecmake\u003C\u002Fcode\u003E），只留下真正需要编译的命令。\u003C\u002Fp\u003E\u003Cp data-pid=\"Bz2dJMm_\"\u003E因此，本质上我们可以认为\u003Ccode\u003Eninja\u003C\u002Fcode\u003E就是一条一条地列出了具体要执行的命令，然后执行即可。\u003C\u002Fp\u003E\u003Cp data-pid=\"UZMCO8HY\"\u003E\u003Ccode\u003Eninja\u003C\u002Fcode\u003E会分析这一系列命令之间的依赖关系，并根据这个依赖关系实现两个重要特点：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"7tPiiHQX\"\u003E并行编译：没有依赖的命令可以并行执行。\u003Ccode\u003Eninja\u003C\u002Fcode\u003E默认使用的并行数为CPU数量，一般不用手动设置并行数，除非想限制\u003Ccode\u003Eninja\u003C\u002Fcode\u003E使用的CPU数量（例如有其他任务在运行，只让\u003Ccode\u003Eninja\u003C\u002Fcode\u003E用一半CPU）。\u003C\u002Fli\u003E\u003Cli data-pid=\"SXQMDZu8\"\u003E增量编译：根据文件的时间戳进行分析，如果某个文件的时间戳发生了改变，则依赖于这个文件的命令以及其他依赖于这个命令的命令都会被重新执行，以此达到增量编译的效果（比如修改了一个文件之后重新编译）。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch2\u003E\u003Cb\u003Eninja 安装方式\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"6pYZe7TP\"\u003E\u003Ccode\u003Eninja\u003C\u002Fcode\u003E是一个工具，而且体量很小。各个系统都有相关的安装方法，具体可参见\u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Fninja-build\u002Fninja\u002Fwiki\u002FPre-built-Ninja-packages\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E文档\u003C\u002Fa\u003E\u003C\u002Fb\u003E。总的来说，有三种安装方式：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"Axj1KBab\"\u003E系统级安装：例如Ubuntu上面的\u003Ccode\u003Eapt-get install ninja-build\u003C\u002Fcode\u003E、MacOS上面的\u003Ccode\u003Ebrew install ninja\u003C\u002Fcode\u003E，安装后\u003Ccode\u003Eninja\u003C\u002Fcode\u003E就是一个系统命令，类似\u003Ccode\u003Els\u002Fcat\u003C\u002Fcode\u003E等命令。\u003C\u002Fli\u003E\u003Cli data-pid=\"qDpE9zD0\"\u003E用户级安装：例如通过\u003Ccode\u003Epip\u003C\u002Fcode\u003E或者\u003Ccode\u003Econda\u003C\u002Fcode\u003E都可以安装\u003Ccode\u003Eninja\u003C\u002Fcode\u003E: \u003Ccode\u003Econda install ninja\u003C\u002Fcode\u003E \u002F \u003Ccode\u003Epip install ninja\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\u003Cli data-pid=\"xn0xGbw8\"\u003E自定义安装：在\u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Fninja-build\u002Fninja\u002Freleases\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003EGitHub下载页面\u003C\u002Fa\u003E\u003C\u002Fb\u003E下载安装包并解压即可，或者下载源码自己编译。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"xMoTRL82\"\u003E\u003Ccode\u003Eninja\u003C\u002Fcode\u003E是个非常小的工具，从下面的下载页面可以看出，整个工具的压缩包也就一两百KB级别。\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-693e36980087d96d3f044facc72a6ff7_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1786\" data-rawheight=\"750\" class=\"origin_image zh-lightbox-thumb\" width=\"1786\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-693e36980087d96d3f044facc72a6ff7_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1786&#39; height=&#39;750&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1786\" data-rawheight=\"750\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1786\" data-original=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-693e36980087d96d3f044facc72a6ff7_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic4.zhimg.com\u002Fv2-693e36980087d96d3f044facc72a6ff7_b.jpg\" data-original-token=\"v2-693e36980087d96d3f044facc72a6ff7\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"vxqnSGWA\"\u003E其实官方只通过GitHub来发布新版本，其它的安装方式都是社区自己搞的。比如\u003Ccode\u003Epip install ninja\u003C\u002Fcode\u003E，安装的是\u003Ccode\u003Escikit-build\u003C\u002Fcode\u003E社区维护的 \u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fgithub.com\u002Fscikit-build\u002Fninja-python-distributions\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E\u003Cspan class=\"invisible\"\u003Ehttps:\u002F\u002F\u003C\u002Fspan\u003E\u003Cspan class=\"visible\"\u003Egithub.com\u002Fscikit-build\u003C\u002Fspan\u003E\u003Cspan class=\"invisible\"\u003E\u002Fninja-python-distributions\u003C\u002Fspan\u003E\u003Cspan class=\"ellipsis\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003E ，他们把\u003Ccode\u003Eninja\u003C\u002Fcode\u003E包装成了一个\u003Ccode\u003Epip\u003C\u002Fcode\u003E包。很多人不知道他们下载的不是官方ninja，这个GitHub项目\u003Cb\u003E才46个star，但是有二百五十万次下载\u003C\u002Fb\u003E。\u003Ccode\u003Econda install ninja\u003C\u002Fcode\u003E也是一个类似的东西。\u003C\u002Fp\u003E\u003Cp data-pid=\"XE3I_SNa\"\u003E总之，\u003Cb\u003E如果需要保证安全，可以通过\u003Ccode\u003Eninja\u003C\u002Fcode\u003E的GitHub release页面下载；如果图方便，可以用各种社区维护的安装方式\u003C\u002Fb\u003E。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E理解ninja文件\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"OO6SsAH_\"\u003E\u003Ccode\u003Eninja\u003C\u002Fcode\u003E的构建配置文件一般叫\u003Ccode\u003Ebuild.ninja\u003C\u002Fcode\u003E。虽然我们一般不写它，但是需要大致看懂它，以便调试或者理解构建过程。\u003C\u002Fp\u003E\u003Cp data-pid=\"i-m5DZ95\"\u003E下面以一个简单的例子来说明常见的\u003Ccode\u003Eninja\u003C\u002Fcode\u003E配置：\u003C\u002Fp\u003E\u003Cp data-pid=\"42cd9r6E\"\u003E有两个头文件\u003Ccode\u003Ea1.h\u003C\u002Fcode\u003E和\u003Ccode\u003Ea2.h\u003C\u002Fcode\u003E，分别定义了一个变量\u003Ccode\u003Ea\u003C\u002Fcode\u003E，但是有不同的值：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E\u002F\u002F a1.h\nint a = 1;\n\n\u002F\u002F a2.h\nint a = 2;\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"OBTf1lZz\"\u003E一份源文件\u003Ccode\u003Ea.cpp\u003C\u002Fcode\u003E里根据宏的不同来包含这两个文件中的某一个：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E\u002F\u002F a.cpp\n#include&lt;iostream&gt;\n\nusing namespace ::std;\n\n#ifdef USE_A1\n#include &#34;a1.h&#34;\n#endif\n\n#ifdef USE_A2\n#include &#34;a2.h&#34;\n#endif\n\nint main()\n{\n    cout &lt;&lt; &#34;hello, world from &#34; &lt;&lt; a &lt;&lt; &#34;!\\n&#34;;\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"iLwltlg0\"\u003E一份\u003Ccode\u003Ebuild.ninja\u003C\u002Fcode\u003E文件包含\u003Ccode\u003Eninja\u003C\u002Fcode\u003E的构建配置（\u003Cb\u003E注意最后的换行，是必要的\u003C\u002Fb\u003E）：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003E# build.ninja\ncxxflags = -DUSE_A1\n\nrule compile\n    description = compile with $cxxflags\n    command = g++ -MM -MF $out.d -MT $out $cxxflags $in &amp;&amp; g++ $cxxflags $in -o $out\n    depfile = $out.d\n\nbuild compile_with_default_cxxflags: compile a.cpp\n\nbuild compile_with_shadow_cxxflags: compile a.cpp\n    cxxflags = -DUSE_A2\n\ndefault compile_with_default_cxxflags\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"Z4DnWL4e\"\u003E这份配置里包含了以下常见内容：\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli data-pid=\"07LrVBgU\"\u003E注释（comment），\u003Ccode\u003Ebuild.ninja\u003C\u002Fcode\u003E里用\u003Ccode\u003E#\u003C\u002Fcode\u003E开头的行表示注释，这个没什么好解释的。\u003C\u002Fli\u003E\u003Cli data-pid=\"UeRHTk1i\"\u003E变量（variable），\u003Ccode\u003Ecxxflags = -DUSE_A1\u003C\u002Fcode\u003E定义了一个变量\u003Ccode\u003Ecxxflags\u003C\u002Fcode\u003E，其值为\u003Ccode\u003E-DUSE_A1\u003C\u002Fcode\u003E。这个变量的值在后面的代码中都可以用，引用方式为\u003Ccode\u003E$cxxflags\u003C\u002Fcode\u003E。具体来说，\u003Ccode\u003E-DUSE_A1\u003C\u002Fcode\u003E就是在编译之前定义名为\u003Ccode\u003EUSE_A1\u003C\u002Fcode\u003E的宏。\u003C\u002Fli\u003E\u003Cli data-pid=\"64S76W0o\"\u003E规则（rule），语法为\u003Ccode\u003Erule \u003C\u002Fcode\u003E加上规则的名字。这里我们定义了一个名为\u003Ccode\u003Ecompile\u003C\u002Fcode\u003E的规则。规则内有默认变量\u003Ccode\u003E$in\u003C\u002Fcode\u003E和\u003Ccode\u003E$out\u003C\u002Fcode\u003E，\u003Ccode\u003E$in\u003C\u002Fcode\u003E表示输入文件的列表，\u003Ccode\u003E$out\u003C\u002Fcode\u003E表示输出文件名。\u003C\u002Fli\u003E\u003Cli data-pid=\"ocC7vt8P\"\u003E规则的文字描述（description），用于在编译过程中展示并告诉用户目前在干什么。\u003C\u002Fli\u003E\u003Cli data-pid=\"UNXTirrj\"\u003E规则的具体命令（command），写明具体的编译命令。\u003C\u002Fli\u003E\u003Cli data-pid=\"O4BmxmFn\"\u003E规则的依赖项记录文件（depfile），用于增量编译，详见后面的解释。\u003C\u002Fli\u003E\u003Cli data-pid=\"E7Kc4OCF\"\u003E构建（build），语法为\u003Ccode\u003Ebuild\u003C\u002Fcode\u003E加上构建的文件名，加上冒号\u003Ccode\u003E:\u003C\u002Fcode\u003E以及规则名、输入文件列表。本质上\u003Ccode\u003Ebuild $out: $rule $in\u003C\u002Fcode\u003E就是把\u003Ccode\u003E$in\u003C\u002Fcode\u003E和\u003Ccode\u003E$out\u003C\u002Fcode\u003E传给\u003Ccode\u003E$rule\u003C\u002Fcode\u003E，然后运行它的\u003Ccode\u003Ecommand\u003C\u002Fcode\u003E命令。\u003C\u002Fli\u003E\u003Cli data-pid=\"LCMJacIB\"\u003E构建里的局部变量，在\u003Ccode\u003Ebuild\u003C\u002Fcode\u003E下面的任意变量，在本次构建命令中覆盖全局的变量。具体来说，\u003Ccode\u003Ebuild compile_with_shadow_cxxflags\u003C\u002Fcode\u003E里定义的\u003Ccode\u003Ecxxflags\u003C\u002Fcode\u003E会覆盖本次\u003Ccode\u003Ecompile\u003C\u002Fcode\u003E命令用到的\u003Ccode\u003Ecxxflags\u003C\u002Fcode\u003E。\u003C\u002Fli\u003E\u003Cli data-pid=\"eJI8juTp\"\u003E默认构建目标（default）。可以存在多行\u003Ccode\u003Edefault\u003C\u002Fcode\u003E，最后的默认构建目标就是它们的并集。如果没有任何\u003Ccode\u003Edefault\u003C\u002Fcode\u003E，则默认构建全部的\u003Ccode\u003Ebuild\u003C\u002Fcode\u003E条目。\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp data-pid=\"uhi0WOsv\"\u003E有了这份\u003Ccode\u003Ebuild.ninja\u003C\u002Fcode\u003E，我们可以通过\u003Ccode\u003Eninja\u003C\u002Fcode\u003E或者\u003Ccode\u003Eninja compile_with_default_cxxflags\u003C\u002Fcode\u003E来构建默认的代码，得到可执行文件\u003Ccode\u003Ecompile_with_default_cxxflags\u003C\u002Fcode\u003E（执行后输出\u003Ccode\u003Ehello, world from 1!\u003C\u002Fcode\u003E）；也可以通过\u003Ccode\u003Eninja compile_with_shadow_cxxflags\u003C\u002Fcode\u003E得到可执行文件\u003Ccode\u003Ecompile_with_shadow_cxxflags\u003C\u002Fcode\u003E（执行后输出\u003Ccode\u003Ehello, world from 2!\u003C\u002Fcode\u003E）。我们也可以修改\u003Ccode\u003Ea1.h\u003C\u002Fcode\u003E或者\u003Ccode\u003Ea2.h\u003C\u002Fcode\u003E，观察\u003Ccode\u003Eninja\u003C\u002Fcode\u003E是否会重新编译。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E理解\u003Ccode\u003Eninja\u003C\u002Fcode\u003E的增量编译\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"MaUDS_zY\"\u003E这份\u003Ccode\u003Ebuild.ninja\u003C\u002Fcode\u003E里的大部分内容简单易懂，唯一难以理解的就是用于增量编译的\u003Ccode\u003Edepfile = $out.d\u003C\u002Fcode\u003E。\u003C\u002Fp\u003E\u003Cp data-pid=\"TwP93OQM\"\u003E首先，\u003Ccode\u003E$out\u003C\u002Fcode\u003E是\u003Ccode\u003Eninja\u003C\u002Fcode\u003E的默认变量，表示构建的目标文件名。所以\u003Ccode\u003E$out.d\u003C\u002Fcode\u003E就是目标文件名加上\u003Ccode\u003E.d\u003C\u002Fcode\u003E。比如\u003Ccode\u003Ebuild compile_with_default_cxxflags\u003C\u002Fcode\u003E里，\u003Ccode\u003Edepfile\u003C\u002Fcode\u003E就是\u003Ccode\u003Ecompile_with_default_cxxflags.d\u003C\u002Fcode\u003E。\u003C\u002Fp\u003E\u003Cp data-pid=\"HBXAFqyP\"\u003E然后我们需要理解增量构建的目标：我们的\u003Ccode\u003Ebuild compile_with_default_cxxflags\u003C\u002Fcode\u003E构建条目中，只传入了\u003Ccode\u003Ea.cpp\u003C\u002Fcode\u003E这一个文件，但是实际上我们的代码里面包含了\u003Ccode\u003Ea1.h\u003C\u002Fcode\u003E或者\u003Ccode\u003Ea2.h\u003C\u002Fcode\u003E。如何能够让\u003Ccode\u003Eninja\u003C\u002Fcode\u003E知道增量构建的时候需要检查\u003Ccode\u003Ea1.h\u003C\u002Fcode\u003E或者\u003Ccode\u003Ea2.h\u003C\u002Fcode\u003E呢？这就需要编译器的支持了：\u003Ccode\u003Eg++\u003C\u002Fcode\u003E的\u003Ccode\u003E-MM -MF $out.d\u003C\u002Fcode\u003E参数会将文件与头文件的依赖关系输出到\u003Ccode\u003E$out.d\u003C\u002Fcode\u003E中，下次\u003Ccode\u003Eninja\u003C\u002Fcode\u003E就会通过这个文件的内容来判断具体需要检查发生改变的文件。\u003C\u002Fp\u003E\u003Cp data-pid=\"fYhhJr39\"\u003E例如，\u003Ccode\u003Ecompile_with_default_cxxflags.d\u003C\u002Fcode\u003E文件里，就有以下内容：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Ecompile_with_default_cxxflags: a.cpp a1.h\n\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"Ttzkf6U6\"\u003E下次\u003Ccode\u003Eninja\u003C\u002Fcode\u003E再\u003Ccode\u003Ebuild compile_with_default_cxxflags\u003C\u002Fcode\u003E的时候，就会检查这个文件，然后查看\u003Ccode\u003Ea.cpp\u003C\u002Fcode\u003E与\u003Ccode\u003Ea1.h\u003C\u002Fcode\u003E的修改时间，如果任何一个文件被修改了，就重新编译。另外，如果\u003Ccode\u003Ecompile_with_default_cxxflags\u003C\u002Fcode\u003E文件不在了，\u003Ccode\u003Eninja\u003C\u002Fcode\u003E也会重新编译（这个很好理解）。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E\u003Ccode\u003Eninja\u003C\u002Fcode\u003E进阶用法\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"dMrzy8_Q\"\u003E很多\u003Ccode\u003Eninja.build\u003C\u002Fcode\u003E里存在\u003Ccode\u003Ephony\u003C\u002Fcode\u003E规则。这是一个内置规则，意思是“假冒的”，就是一个不存在规则的规则。我们可以理解为：\u003C\u002Fp\u003E\u003Cdiv class=\"highlight\"\u003E\u003Cpre\u003E\u003Ccode class=\"language-text\"\u003Erule phony\n    command = : $in $out\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\u003Cp data-pid=\"g0Cu6Tfc\"\u003E其中冒号\u003Ccode\u003E:\u003C\u002Fcode\u003E是unix系统里的一个命令，不管参数是什么，永远正常退出。因此，\u003Ccode\u003Ephony\u003C\u002Fcode\u003E规则不会做什么，但是\u003Cb\u003E会在输入和输出之间建立依赖关系\u003C\u002Fb\u003E。\u003C\u002Fp\u003E\u003Cp data-pid=\"M8oLUgO4\"\u003E不带参数的\u003Ccode\u003Eninja\u003C\u002Fcode\u003E命令会构建文件里的\u003Ccode\u003Edefault\u003C\u002Fcode\u003E构建目标。我们也可以用\u003Ccode\u003Eninja compile_with_shadow_cxxflags\u003C\u002Fcode\u003E来手动构建某个目标。\u003C\u002Fp\u003E\u003Cp data-pid=\"Zo3gpAkp\"\u003E构建多个目标（比如PyTorch有上千个目标）的时候，\u003Ccode\u003Eninja\u003C\u002Fcode\u003E会展示一个进度条，进度条展现的内容就是\u003Ccode\u003Erule\u003C\u002Fcode\u003E下面的\u003Ccode\u003Edescription\u003C\u002Fcode\u003E字段的内容。\u003C\u002Fp\u003E\u003Cp data-pid=\"EJOVTqZp\"\u003E\u003Ccode\u003Eninja\u003C\u002Fcode\u003E的高级用法一般都在\u003Ccode\u003Eninja -t\u003C\u002Fcode\u003E下面，例如\u003Ccode\u003Eninja -t clean\u003C\u002Fcode\u003E可以清理全部生成文件、\u003Ccode\u003Eninja -t browse\u003C\u002Fcode\u003E可以打开一个网页浏览器查看文件之间的依赖图（默认查看的是名为\u003Ccode\u003Eall\u003C\u002Fcode\u003E的依赖图）：\u003C\u002Fp\u003E\u003Cfigure data-size=\"normal\"\u003E\u003Cnoscript\u003E\u003Cimg src=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-d69b6f0baa79bc67a3ffea047c3d677c_b.jpg\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1102\" data-rawheight=\"756\" class=\"origin_image zh-lightbox-thumb\" width=\"1102\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-d69b6f0baa79bc67a3ffea047c3d677c_r.jpg\"\u002F\u003E\u003C\u002Fnoscript\u003E\u003Cimg src=\"data:image\u002Fsvg+xml;utf8,&lt;svg xmlns=&#39;http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg&#39; width=&#39;1102&#39; height=&#39;756&#39;&gt;&lt;\u002Fsvg&gt;\" data-caption=\"\" data-size=\"normal\" data-rawwidth=\"1102\" data-rawheight=\"756\" class=\"origin_image zh-lightbox-thumb lazy\" width=\"1102\" data-original=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-d69b6f0baa79bc67a3ffea047c3d677c_r.jpg\" data-actualsrc=\"https:\u002F\u002Fpic1.zhimg.com\u002Fv2-d69b6f0baa79bc67a3ffea047c3d677c_b.jpg\" data-original-token=\"v2-d69b6f0baa79bc67a3ffea047c3d677c\"\u002F\u003E\u003C\u002Ffigure\u003E\u003Cp data-pid=\"tOuSObFB\"\u003E通过这个浏览器界面，我们可以很方便地查看什么文件依赖于什么文件。打开\u003Ccode\u003Ehttp:\u002F\u002Flocalhost:8000\u002F?libtorch.so\u003C\u002Fcode\u003E就可以看到完整的\u003Ccode\u003Elibtorch.so\u003C\u002Fcode\u003E对应的依赖，再也不用对着\u003Ccode\u003ECMakeLists.txt\u003C\u002Fcode\u003E瞎猜了。（还可以通过\u003Ccode\u003Eninja -t graph\u003C\u002Fcode\u003E直接导出依赖图的dot graph文件，但是大型项目的依赖图一般都非常复杂，看起来不方便。）\u003C\u002Fp\u003E\u003Cp data-pid=\"WSlFAZWC\"\u003E最后，\u003Ccode\u003Eninja -t targets all\u003C\u002Fcode\u003E得到的是全部的构建目标，可以用于\u003Ccode\u003Egrep\u003C\u002Fcode\u003E搜索想要的内容；\u003Ccode\u003Eninja -C \u002Fpath\u002Fto\u002Fdir -f \u002Fpath\u002Fto\u002Ffile\u003C\u002Fcode\u003E可以让\u003Ccode\u003Eninja\u003C\u002Fcode\u003E切换到\u003Ccode\u003E\u002Fpath\u002Fto\u002Fdir\u003C\u002Fcode\u003E去执行命令、并读取\u003Ccode\u003E\u002Fpath\u002Fto\u002Ffile\u003C\u002Fcode\u003E配置文件来执行。\u003Ccode\u003E-f\u003C\u002Fcode\u003E的默认参数是\u003Ccode\u003Ebuild.ninja\u003C\u002Fcode\u003E，\u003Ccode\u003E-C\u003C\u002Fcode\u003E的默认参数为\u003Ccode\u003E.\u003C\u002Fcode\u003E，也就是当前路径。一般来说\u003Ccode\u003E-f\u003C\u002Fcode\u003E参数用得很少，\u003Ccode\u003E-C\u003C\u002Fcode\u003E参数用得比较多。\u003C\u002Fp\u003E\u003Ch2\u003E\u003Cb\u003E总结\u003C\u002Fb\u003E\u003C\u002Fh2\u003E\u003Cp data-pid=\"pouxidef\"\u003E本文简单介绍了\u003Ccode\u003Eninja\u003C\u002Fcode\u003E的一些原理及用法。虽然简单，但依然起了个“一文读懂ninja构建系统”的标题，就是因为\u003Ccode\u003Eninja\u003C\u002Fcode\u003E真的很小，它的\u003Cb\u003E\u003Ca href=\"https:\u002F\u002Flink.zhihu.com\u002F?target=https%3A\u002F\u002Fninja-build.org\u002Fmanual.html\" class=\" wrap external\" target=\"_blank\" rel=\"nofollow noreferrer\"\u003E全部文档\u003C\u002Fa\u003E\u003C\u002Fb\u003E差不多也就这些值得我们关心的内容。\u003C\u002Fp\u003E","adminClosedComment":false,"topics":[{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19834837","type":"topic","id":"19834837","name":"CMake"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F20075993","type":"topic","id":"20075993","name":"PyTorch"},{"url":"https:\u002F\u002Fwww.zhihu.com\u002Fapi\u002Fv4\u002Ftopics\u002F19601705","type":"topic","id":"19601705","name":"C \u002F C++"}],"voteupCount":74,"voting":0,"heavyUpStatus":"allow_heavy_up","commentCount":2,"contributions":[],"isTitleImageFullScreen":false,"upvotedFollowees":[],"commercialInfo":{"isCommercial":false,"plugin":{}},"suggestEdit":{"status":false,"reason":"","tip":"","url":"","title":""},"reason":"","annotationAction":[],"canTip":false,"tipjarorsCount":0,"isLabeled":false,"hasPublishingDraft":false,"isFavorited":true,"favlistsCount":108,"isNormal":true,"status":0,"activityToppingInfo":{"state":"untopped"},"shareText":"一文读懂ninja构建系统 - 来自知乎专栏，作者: 游凯超 https:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F676733751 （想看更多？下载 @知乎 App：http:\u002F\u002Fweibo.com\u002Fp\u002F100404711598 ）","canComment":{"status":true,"reason":""},"mcnFpShow":-1,"isVisible":true,"isLiked":false,"likedCount":4,"hasColumn":false,"republishers":[],"isNewLinkCard":true,"emojiReaction":{"likeCount":4,"likeHasSet":false},"abParam":{"qaHiddenVoteup":"1","rsInterest1":"","zpZhiStyle":"0"},"attachedInfo":"kgIkCgkyMzg1MTU0MzASCTY3NjczMzc1MRgHIgpJTUFHRV9URVhU","shareGuide":{"hasPositiveBubble":false,"hasTimeBubble":false,"hitShareGuideCluster":false},"settings":{"tableOfContents":{"enabled":false}},"canReference":false,"reactionInstruction":{}}},"columns":{},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{},"pins":{},"promotions":{},"drafts":{},"chats":{},"posts":{},"zvideos":{},"zvideoContributions":{},"briefs":{},"eduCourses":{}},"currentUser":"b9aa258fe18286f8cbede71553d2ffee","account":{"unlockTicketStatus":false,"unlockTicket":null,"challenge":[],"errorStatus":false,"message":"","isFetching":false,"accountInfo":{},"urlToken":{"loading":false},"cardUserInfo":{"vipInfo":{}},"handleWidget":{},"widgetList":[],"userWidgetId":""},"settings":{"socialBind":null,"inboxMsg":null,"notification":{},"email":{},"privacyFlag":null,"blockedUsers":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"blockedFollowees":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"ignoredTopics":{"isFetching":false,"paging":{"pageNo":1,"pageSize":6},"data":[]},"restrictedTopics":null,"laboratory":{}},"notification":{},"people":{"profileStatus":{},"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersIncludedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"zvideosByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"articlesIncludedByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{},"brands":null,"creationsByUser":{},"creationsSortByVotesByUser":{},"creationsFeed":{},"infinity":{},"batchUsers":{},"profileInfinity":null},"env":{"ab":{"config":{},"triggers":{}},"abV2":{"config":{"paramMap":{"ws_publish_ask":{"value":"0"},"ws_publish_post":{"value":"0"},"uw_pc_pin_pattern":{"value":"0","abId":"pc_pin_pattern-0"},"ws_platform_new":{"value":"1","abId":"author_platform-1"},"in_editor_title":{"value":"1","abId":"rl-pineditor_title-1"},"pc_mou_cre_remove":{"value":"1","abId":"rl-mou_create_remove-1"},"ws_video_publish":{"value":"0"},"ws_publish_answer":{"value":"1","abId":"rl-pc_publish_answer-1"}},"abMap":{"pc_pin_pattern-0":{"abId":"pc_pin_pattern-0","layerId":"pc_pin_pattern_layer","diversionType":2},"author_platform-1":{"abId":"author_platform-1","layerId":"author_platform_layer","diversionType":2},"rl-pineditor_title-1":{"abId":"rl-pineditor_title-1","layerId":"rl-pineditor_title","diversionType":2},"rl-mou_create_remove-1":{"abId":"rl-mou_create_remove-1","layerId":"rl-mou_create_remove","diversionType":2},"rl-pc_publish_answer-1":{"abId":"rl-pc_publish_answer-1","layerId":"rl-pc_publish_answer","diversionType":2}}},"triggers":{}},"userAgent":{"Edge":false,"IE":false,"Wechat":false,"Weibo":false,"QQ":false,"MQQBrowser":false,"Qzone":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":false,"Zhihu":false,"ZhihuHybrid":false,"isBot":false,"Tablet":false,"UC":false,"Quark":false,"Sogou":false,"Qihoo":false,"Baidu":false,"BaiduApp":false,"Safari":false,"GoogleBot":false,"AndroidDaily":false,"iOSDaily":false,"WxMiniProgram":false,"BaiduMiniProgram":false,"QQMiniProgram":false,"JDMiniProgram":false,"isWebView":false,"isMiniProgram":false,"origin":"Mozilla\u002F5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\u002F537.36 (KHTML, like Gecko) Chrome\u002F120.0.0.0 Safari\u002F537.36 Edg\u002F120.0.0.0"},"appViewConfig":{},"ctx":{"path":"\u002Fp\u002F676733751","query":{},"href":"http:\u002F\u002Fzhuanlan.zhihu.com\u002Fp\u002F676733751","host":"zhuanlan.zhihu.com"},"trafficSource":"production","edition":{"beijing":false,"baidu":false,"sogou":false,"baiduBeijing":false,"sogouBeijing":false,"sogouInput":false,"oppoSearch":false,"baiduSearch":false,"googleSearch":false,"shenma":false,"miniProgram":false,"xiaomi":false,"huaweiSearch":false},"theme":"light","appHeaderTheme":{"current":"normal","disable":true,"normal":{"bgColor":"GBK99A"},"custom":{"bgColor":"GBK99A"}},"enableShortcut":true,"referer":"","xUDId":"AIATsvB5qhePTukB8o0Nb75ogj7pdOmpk14=","mode":"ssr","conf":{},"xTrafficFreeOrigin":"","ipInfo":{"cityName":"湖州","countryName":"中国","regionName":"浙江","countryCode":"CN"},"logged":true,"vars":{"passThroughHeaders":{}}},"me":{"columnContributions":[]},"label":{},"ecommerce":{},"comments":{"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"commentsV2":{"stickers":[],"commentWithPicPermission":{},"notificationsComments":{},"pagination":{},"collapsed":{},"reverse":{},"reviewing":{},"conversation":{},"conversationMore":{},"parent":{}},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote_thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote_thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginUnregisteredError":false,"loginBindWechatError":false,"loginConfirmError":null,"sendDigitsError":null,"needSMSIdentify":false,"validateDigitsError":false,"loginConfirmSucceeded":null,"qrcodeLoginToken":"","qrcodeLoginScanStatus":0,"qrcodeLoginError":null,"qrcodeLoginReturnNewToken":false},"switches":{},"captcha":{"captchaNeeded":false,"captchaValidated":false},"sms":{"supportedCountries":[]},"chat":{"chats":{},"inbox":{"recents":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"strangers":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"friends":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"search":{"isFetching":false,"isDrained":false,"isPrevDrained":false,"result":[],"next":null,"key":null},"config":{"newCount":0,"strangerMessageSwitch":false,"strangerMessageUnread":false,"friendCount":0}},"global":{"isChatMqttExisted":false}},"emoticons":{"emoticonGroupList":[],"emoticonGroupDetail":{}},"creator":{"tools":{"question":{"invitationCount":{"questionFolloweeCount":0,"questionTotalCount":0}},"recommend":{"recommendTimes":{}}},"explore":{},"levelUpperLimit":10,"mcn":{},"mcnManage":{},"tasks":{},"announcement":{},"creatorsRecommendInfo":{}},"creators":{"common":{"applyStatus":{},"rightsStatus":{}},"bayesDomains":{"status":{},"options":{"topDomains":null,"allDomains":null,"editable":0},"contents":null},"school":{"tabs":[],"contents":[],"banner":null,"entities":{}},"faq":{"tabs":[],"article":{}},"knowledgeIncome":{},"safeguardRights":{},"analytics":{"all":{},"answer":{},"zvideo":{},"article":{},"pin":{},"singleContent":{}},"account":{"growthLevel":{}},"KMResource":{},"training":{},"ToolsQuestion":{"goodatTopics":[]},"ToolsHotspot":{"domains":[]},"ToolsRecommend":{},"ToolsCustomPromotion":{"itemLists":{},"baseInfo":{}},"ToolsSearchQuestion":{},"editorSetting":{},"MCNManage":{},"knowledgeTasks":{},"incomeAnalysis":{"income":{"aggregation":{}}},"creationManage":{"editModal":{"status":false}},"activity":{},"announcement":{},"home":{"currentCreatorUrlToken":null,"rights":[],"newRights":[],"scoreInfo":{},"menusShowControlByServer":{"bVipRecomend":false,"creationRelationship":false},"newTasks":{"creatorTask":{"tasks":[],"des":[]}},"bannerList":[],"recentlyCreated":[],"homecard":{},"homeData":{}},"videoSupport":{"textBenefit":{}},"videoDistribution":{},"profilePoster":{"creatorPosterConfig":{},"creatorPosterData":{}}},"answers":{"voters":{},"upvoters":{},"copyrightApplicants":{},"favlists":{},"newAnswer":{},"entityWords":{},"paidContent":{},"settings":{},"relationEndorsement":{}},"recommendation":{"homeRecommendations":[]},"shareTexts":{},"articles":{"voters":{},"upvoters":{},"relationEndorsement":{}},"previewPost":{},"favlists":{"relations":{}},"columns":{"voters":{}},"reward":{"answer":{},"article":{},"question":{}},"video":{"data":{},"shareVideoDetail":{},"last":{}},"topstory":{"recommend":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"follow":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followWonderful":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":null,"announcement":{},"hotList":[],"hotListHeadZone":[],"guestFeeds":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"followExtra":{"isNewUser":null,"isFetched":false,"followCount":0,"followers":[]},"hotDaily":{"data":[],"paging":{}},"hotHighlight":{"isFetching":false,"isDrained":false,"data":[],"paging":{}},"banner":{},"commercialBanner":{"show":false,"banner":{},"trackData":{}},"video":{"items":[],"next":null,"isLoading":false,"isDrained":false}},"readStatus":{},"column":{},"requestColumn":{"categories":[],"error":null},"articleContribution":{"contributeRequests":[],"deleteContributeIdList":[],"handledContributeIdList":[],"recommendedColumns":[],"pinnedColumns":[],"sentContributeRequestsIdList":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},"columnContribution":{"contributeRequests":[],"autoInviteEnabled":false,"recommendedContributors":[]},"draftHistory":{"history":{},"drafts":{}},"upload":{},"articleDraft":{"titleImage":"","titleImageSize":{},"isTitleImageFullScreen":false,"canTitleImageFullScreen":false,"title":"","titleImageUploading":false,"error":"","content":"","draftLoading":false,"updating":false,"globalLoading":false,"pendingVideo":{"resource":null,"error":null},"deleteFail":{"fail":false},"recommendTopics":[],"selectedColumn":0,"articleDisclaimers":[]},"articleDrafts":{"isDrained":false,"isLoading":false,"items":[]},"columnAutocomplete":{"users":[],"friends":[]},"columnCollection":{},"userProfit":{"permission":{"permissionStatus":{"zhiZixuan":0,"recommend":-1,"task":0,"plugin":0,"infinity":0},"visible":false},"linkCardLimit":0},"mcn":{"bindInfo":{},"memberCategoryList":[],"producerList":[],"categoryList":[],"lists":{},"banners":{},"protocolStatus":{"isAgreedNew":true,"isAgreedOld":true},"probationCountdownDays":0},"zvideos":{"campaignVideoList":{},"campaigns":{},"tagoreCategory":[],"recommendations":{},"insertable":{},"recruit":{"form":{"platform":"","nickname":"","followerCount":"","domain":"","contact":""},"submited":false,"ranking":[]},"qyActivityData":{},"talkActivityData":{},"party2022ActivityData":{},"batchVideos":{},"contribution":{"selectedContribution":null,"campaign":null,"configs":{},"contributionLists":{},"recommendQuestions":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]},"questionSearchResults":{"isLoading":true,"paging":{"isEnd":false,"isStart":true,"totals":0},"data":[]}},"creationReferences":{},"zvideoCollection":{},"zvideoGrant":{},"collectData":{"isFetching":false,"list":[]},"videoSource":{"isLoaded":false}},"republish":{},"commentPermission":{},"creatorRightStatus":{"list":[]},"adPromotion":{"answer":{},"article":{}}},"fetchHost":"www.zhihu.com","subAppName":"column","spanName":"Post","canaryConfig":{"test_canary":"0","use_new_player":"0","player_vendor":"0","use_hevc":"1","upload_use_signature":"1","use_backdrop_blur":"1","article_title_imagex":"1","play_station":"1","use_cached_supported_countries":"1"}}</script><script crossorigin="" src="https://static.zhihu.com/heifetz/vendor.b2043823c211547b094b.js"></script><script crossorigin="" src="https://static.zhihu.com/event/react@17.0.2/umd/react.production.min.js"></script><script crossorigin="" src="https://static.zhihu.com/event/react-dom@17.0.2/umd/react-dom.production.min.js"></script><script crossorigin="" src="https://static.zhihu.com/event/react-dom@17.0.2/umd/react-dom-server.browser.production.min.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/runtime.app.bf0244516492e591c66c.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/lib-75fc9c18.app.3db651c252e14ef6658e.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/lib-29107295.app.42d07f814b7b05187671.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/lib-79b5cf47.app.8b6b6bf4b6d894db9b07.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/lib-330004dc.app.7437cf54ac28fca0e302.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/lib-0e5ce61e.app.f3d2757e874ba03c7c9f.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/lib-83b0f42f.app.4e3039fff4a43ba7dcec.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/lib-38cf5c11.app.4327099626d1db2de175.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/lib-2ec050f6.app.d883e7af5e9ace574cc1.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/419.app.c80468d83d7f743103a4.js"></script><script crossorigin="" src="https://static.zhihu.com/heifetz/column.app.2bf594f57619a3e24527.js"></script><script defer="" src="https://static.zhihu.com/event/wza/4613/aria.js?appid=a3637ace5dc3a347f6863b0bac487599" id="ariascripts" wapForceOldFixed="false" loadData="false"></script></body><script src="https://hm.baidu.com/hm.js?98beee57fd2ef70ccdd5ca52b9740c49" async=""></script></html>