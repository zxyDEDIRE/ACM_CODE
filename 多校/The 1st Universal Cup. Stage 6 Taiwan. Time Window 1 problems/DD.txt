一般来说，基于纠结的加密货币以如下方式运作。有一个有向无环图（DAG），我们称之为纠结。DAG的网络由节点组成，也就是说，节点是发行和验证交易的实体。节点发出的交易构成了Tangle图的站点集，它是存储交易的账本。Tangle的边集是以下列方式获得的 方式：当一个新的交易X到达时，它必须批准之前的两个交易。这些批准是 如图4(a)所示，用有向边表示。如果在交易A和交易G之间没有一条有向边 A和交易G之间没有有向边，但从A到G有一条长度至少为2的有向路径，我们就说A间接批准了G。在图4（a）中，A直接批准了B和D，间接批准了F、G、H。我们把 "提示 "定义为Tangle图中未被批准的交易。在图4(a)的T角快照中 图4(a)中，提示是A和C。图4(b)的Tangle快照中，X成为唯一的提示。

图4：新发布的交易X前后的权重分配的T角图。方框代表交易，每个方框东南角的小数字表示自己的权重，粗体数字表示累积权重。

我们定义交易的权重和相关概念。一笔交易的权重与发行节点投入的工作量成正比。唯一重要的是，每个交易都有一个正的整数，即它的权重，附在它身上。一般来说，这个想法是，具有较大权重的交易比具有较小权重的交易更 "重要"。假设交易X的自身权重等于WX，其中1≤WX≤Wmax。X的累积权重CWX是其权重与所有直接或间接批准它的交易的权重之和。图4说明了累积权重的计算。盒子代表交易，每个盒子东南角的小数字表示自己的权重，黑体数字表示累积权重。例如，交易F是由交易A、B、C和E直接或间接批准的。

.F的累积权重为CWF=3+1+3+1+1=9，是F的自身权重与A、B、C和E的权重之和。在新的交易X（WX=3）批准后，所有其他交易的累积权重增加了3。因此，一旦它达到一个阈值T H，该交易就被标记为确认，因为恶意修改的概率很低。换句话说，随着交易获得更多的批准，它被系统以更高的信心水平接受。累计权重小于上限的已批准交易被称为未确认交易。如图4所示，如果我们假设T H = 12，交易F、G、H和I都被确认。在T角的开始，有一个地址的余额包含所有的代币。创世交易将这些代币发送到其他几个 "创始人 "地址。所有的代币都是在 "创世纪 "交易中产生的。因此，"创世 "交易直接或间接地被所有其他交易批准（在图5中）。最初，当一个节点创建一个交易时，它根据一个提示选择算法选择两个提示（未批准的交易）。每个新的交易应该批准两个以前的交易，这些交易用有向边表示。网络中的其他节点将验证该交易，并将其添加为DAG中的一个新提示。当一个交易被添加为DAG中的一个小费时，它是未被批准的。当任何进一步的交易选择该小费时，它就会被批准。每当有交易直接/间接批准某项交易时，与该交易相关的累积权重将被更新。

图5：带有每个交易的权重分配的Tangle图

为方便起见，图6(a)中显示了初始的Tangle。一个新创建的交易X将根据一个提示选择算法选择两个提示Y和Z（未批准的交易）。图6（b）显示了X、Y和Z的权重和累积权重的符号，分别为

图6：带有每个交易的权重分配的纠结图

图7：样本输入1的纠结图，其中T H=12（T2和T3的CWX≥T H）。

输入
输入的第一行是一对整数n TH，其中n表示交易的数量，T H表示累积权重的阈值。交易按X的递增顺序输入，每个交易在一行中，包含一个整数列表。X Y Z WX，其中2≤X≤10000，0≤Y，Z≤X-1，Y̸=Z，和1≤WX≤5。


输出
在处理完n个交易后，对于{T2, T3 ... ..., Tn}中的交易TX，如果CWX≥100，则该交易将在{T2, T3 ... , Tn}中的一个交易，如果CWX≥T H，则输出值的列表。X CWX按X的递增顺序排列，每行包含一个交易。最后，输出确认交易的总数